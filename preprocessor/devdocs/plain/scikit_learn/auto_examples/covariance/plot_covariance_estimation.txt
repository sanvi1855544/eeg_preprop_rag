# Shrinkage covariance estimation: LedoitWolf vs OAS and max-likelihood

When working with covariance estimation, the usual approach is to use a
maximum likelihood estimator, such as the `EmpiricalCovariance`. It is
unbiased, i.e. it converges to the true (population) covariance when given
many observations. However, it can also be beneficial to regularize it, in
order to reduce its variance; this, in turn, introduces some bias. This
example illustrates the simple regularization used in Shrunk Covariance
estimators. In particular, it focuses on how to set the amount of
regularization, i.e. how to choose the bias-variance trade-off.

Here we compare 3 approaches:

  * Setting the parameter by cross-validating the likelihood on three folds according to a grid of potential shrinkage parameters.
  * A close formula proposed by Ledoit and Wolf to compute the asymptotically optimal regularization parameter (minimizing a MSE criterion), yielding the `LedoitWolf` covariance estimate.
  * An improvement of the Ledoit-Wolf shrinkage, the `OAS`, proposed by Chen et al. Its convergence is significantly better under the assumption that the data are Gaussian, in particular for small samples.

To quantify estimation error, we plot the likelihood of unseen data for
different values of the shrinkage parameter. We also show the choices by
cross-validation, or with the LedoitWolf and OAS estimates.

Note that the maximum likelihood estimate corresponds to no shrinkage, and
thus performs poorly. The Ledoit-Wolf estimate performs really well, as it is
close to the optimal and is computational not costly. In this example, the OAS
estimate is a bit further away. Interestingly, both approaches outperform
cross-validation, which is significantly most computationally costly.

![Regularized covariance: likelihood and shrinkage
coefficient](data:image/png;base64,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)

    
    print(__doc__)
    
    import numpy as np
    import matplotlib.pyplot as plt
    from scipy import linalg
    
    from sklearn.covariance import LedoitWolf, OAS, ShrunkCovariance, \
        log_likelihood, empirical_covariance
    from sklearn.model_selection import GridSearchCV
    
    
    # #############################################################################
    # Generate sample data
    n_features, n_samples = 40, 20
    np.random.seed(42)
    base_X_train = np.random.normal(size=(n_samples, n_features))
    base_X_test = np.random.normal(size=(n_samples, n_features))
    
    # Color samples
    coloring_matrix = np.random.normal(size=(n_features, n_features))
    X_train = np.dot(base_X_train, coloring_matrix)
    X_test = np.dot(base_X_test, coloring_matrix)
    
    # #############################################################################
    # Compute the likelihood on test data
    
    # spanning a range of possible shrinkage coefficient values
    shrinkages = np.logspace(-2, 0, 30)
    negative_logliks = [-ShrunkCovariance(shrinkage=s).fit(X_train).score(X_test)
                        for s in shrinkages]
    
    # under the ground-truth model, which we would not have access to in real
    # settings
    real_cov = np.dot(coloring_matrix.T, coloring_matrix)
    emp_cov = empirical_covariance(X_train)
    loglik_real = -log_likelihood(emp_cov, linalg.inv(real_cov))
    
    # #############################################################################
    # Compare different approaches to setting the parameter
    
    # GridSearch for an optimal shrinkage coefficient
    tuned_parameters = [{'shrinkage': shrinkages}]
    cv = GridSearchCV(ShrunkCovariance(), tuned_parameters)
    cv.fit(X_train)
    
    # Ledoit-Wolf optimal shrinkage coefficient estimate
    lw = LedoitWolf()
    loglik_lw = lw.fit(X_train).score(X_test)
    
    # OAS coefficient estimate
    oa = OAS()
    loglik_oa = oa.fit(X_train).score(X_test)
    
    # #############################################################################
    # Plot results
    fig = plt.figure()
    plt.title("Regularized covariance: likelihood and shrinkage coefficient")
    plt.xlabel('Regularization parameter: shrinkage coefficient')
    plt.ylabel('Error: negative log-likelihood on test data')
    # range shrinkage curve
    plt.loglog(shrinkages, negative_logliks, label="Negative log-likelihood")
    
    plt.plot(plt.xlim(), 2 * [loglik_real], '--r',
             label="Real covariance likelihood")
    
    # adjust view
    lik_max = np.amax(negative_logliks)
    lik_min = np.amin(negative_logliks)
    ymin = lik_min - 6. * np.log((plt.ylim()[1] - plt.ylim()[0]))
    ymax = lik_max + 10. * np.log(lik_max - lik_min)
    xmin = shrinkages[0]
    xmax = shrinkages[-1]
    # LW likelihood
    plt.vlines(lw.shrinkage_, ymin, -loglik_lw, color='magenta',
               linewidth=3, label='Ledoit-Wolf estimate')
    # OAS likelihood
    plt.vlines(oa.shrinkage_, ymin, -loglik_oa, color='purple',
               linewidth=3, label='OAS estimate')
    # best CV estimator likelihood
    plt.vlines(cv.best_estimator_.shrinkage, ymin,
               -cv.best_estimator_.score(X_test), color='cyan',
               linewidth=3, label='Cross-validation best estimate')
    
    plt.ylim(ymin, ymax)
    plt.xlim(xmin, xmax)
    plt.legend()
    
    plt.show()
    
Total running time of the script: ( 0 minutes 0.669 seconds)

![Launch
binder](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC)

`Download Python source code: plot_covariance_estimation.py`

`Download Jupyter notebook: plot_covariance_estimation.ipynb`

© 2007–2020 The scikit-learn developers  
Licensed under the 3-clause BSD License.  
https://scikit-
learn.org/0.24/auto_examples/covariance/plot_covariance_estimation.html

