# Ledoit-Wolf vs OAS estimation

The usual covariance maximum likelihood estimate can be regularized using
shrinkage. Ledoit and Wolf proposed a close formula to compute the
asymptotically optimal shrinkage parameter (minimizing a MSE criterion),
yielding the Ledoit-Wolf covariance estimate.

Chen et al. proposed an improvement of the Ledoit-Wolf shrinkage parameter,
the OAS coefficient, whose convergence is significantly better under the
assumption that the data are Gaussian.

This example, inspired from Chen’s publication [1], shows a comparison of the
estimated MSE of the LW and OAS methods, using Gaussian distributed data.

[1] “Shrinkage Algorithms for MMSE Covariance Estimation” Chen et al., IEEE
Trans. on Sign. Proc., Volume 58, Issue 10, October 2010.

    
    print(__doc__)
    
    import numpy as np
    import matplotlib.pyplot as plt
    from scipy.linalg import toeplitz, cholesky
    
    from sklearn.covariance import LedoitWolf, OAS
    
    np.random.seed(0)
    
    
    n_features = 100
    # simulation covariance matrix (AR(1) process)
    r = 0.1
    real_cov = toeplitz(r ** np.arange(n_features))
    coloring_matrix = cholesky(real_cov)
    
    n_samples_range = np.arange(6, 31, 1)
    repeat = 100
    lw_mse = np.zeros((n_samples_range.size, repeat))
    oa_mse = np.zeros((n_samples_range.size, repeat))
    lw_shrinkage = np.zeros((n_samples_range.size, repeat))
    oa_shrinkage = np.zeros((n_samples_range.size, repeat))
    for i, n_samples in enumerate(n_samples_range):
        for j in range(repeat):
            X = np.dot(
                np.random.normal(size=(n_samples, n_features)), coloring_matrix.T)
    
            lw = LedoitWolf(store_precision=False, assume_centered=True)
            lw.fit(X)
            lw_mse[i, j] = lw.error_norm(real_cov, scaling=False)
            lw_shrinkage[i, j] = lw.shrinkage_
    
            oa = OAS(store_precision=False, assume_centered=True)
            oa.fit(X)
            oa_mse[i, j] = oa.error_norm(real_cov, scaling=False)
            oa_shrinkage[i, j] = oa.shrinkage_
    
    # plot MSE
    plt.subplot(2, 1, 1)
    plt.errorbar(n_samples_range, lw_mse.mean(1), yerr=lw_mse.std(1),
                 label='Ledoit-Wolf', color='navy', lw=2)
    plt.errorbar(n_samples_range, oa_mse.mean(1), yerr=oa_mse.std(1),
                 label='OAS', color='darkorange', lw=2)
    plt.ylabel("Squared error")
    plt.legend(loc="upper right")
    plt.title("Comparison of covariance estimators")
    plt.xlim(5, 31)
    
    # plot shrinkage coefficient
    plt.subplot(2, 1, 2)
    plt.errorbar(n_samples_range, lw_shrinkage.mean(1), yerr=lw_shrinkage.std(1),
                 label='Ledoit-Wolf', color='navy', lw=2)
    plt.errorbar(n_samples_range, oa_shrinkage.mean(1), yerr=oa_shrinkage.std(1),
                 label='OAS', color='darkorange', lw=2)
    plt.xlabel("n_samples")
    plt.ylabel("Shrinkage")
    plt.legend(loc="lower right")
    plt.ylim(plt.ylim()[0], 1. + (plt.ylim()[1] - plt.ylim()[0]) / 10.)
    plt.xlim(5, 31)
    
    plt.show()
    
![Comparison of covariance
estimators](data:image/png;base64,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)

Total running time of the script: ( 0 minutes 2.598 seconds)

![Launch
binder](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC)

`Download Python source code: plot_lw_vs_oas.py`

`Download Jupyter notebook: plot_lw_vs_oas.ipynb`

© 2007–2020 The scikit-learn developers  
Licensed under the 3-clause BSD License.  
https://scikit-learn.org/0.24/auto_examples/covariance/plot_lw_vs_oas.html

