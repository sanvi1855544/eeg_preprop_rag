# Lasso on dense and sparse data

We show that linear_model.Lasso provides the same results for dense and sparse
data and that in the case of sparse data the speed is improved.

Out:

    
    --- Dense matrices
    Sparse Lasso done in 0.162110s
    Dense Lasso done in 0.057279s
    Distance between coefficients : 1.0705405751792344e-13
    --- Sparse matrices
    Matrix density : 0.6263000000000001 %
    Sparse Lasso done in 0.188596s
    Dense Lasso done in 1.788049s
    Distance between coefficients : 7.928463765972842e-12
    
    
    print(__doc__)
    
    from time import time
    from scipy import sparse
    from scipy import linalg
    
    from sklearn.datasets import make_regression
    from sklearn.linear_model import Lasso
    
    
    # #############################################################################
    # The two Lasso implementations on Dense data
    print("--- Dense matrices")
    
    X, y = make_regression(n_samples=200, n_features=5000, random_state=0)
    X_sp = sparse.coo_matrix(X)
    
    alpha = 1
    sparse_lasso = Lasso(alpha=alpha, fit_intercept=False, max_iter=1000)
    dense_lasso = Lasso(alpha=alpha, fit_intercept=False, max_iter=1000)
    
    t0 = time()
    sparse_lasso.fit(X_sp, y)
    print("Sparse Lasso done in %fs" % (time() - t0))
    
    t0 = time()
    dense_lasso.fit(X, y)
    print("Dense Lasso done in %fs" % (time() - t0))
    
    print("Distance between coefficients : %s"
          % linalg.norm(sparse_lasso.coef_ - dense_lasso.coef_))
    
    # #############################################################################
    # The two Lasso implementations on Sparse data
    print("--- Sparse matrices")
    
    Xs = X.copy()
    Xs[Xs < 2.5] = 0.0
    Xs = sparse.coo_matrix(Xs)
    Xs = Xs.tocsc()
    
    print("Matrix density : %s %%" % (Xs.nnz / float(X.size) * 100))
    
    alpha = 0.1
    sparse_lasso = Lasso(alpha=alpha, fit_intercept=False, max_iter=10000)
    dense_lasso = Lasso(alpha=alpha, fit_intercept=False, max_iter=10000)
    
    t0 = time()
    sparse_lasso.fit(Xs, y)
    print("Sparse Lasso done in %fs" % (time() - t0))
    
    t0 = time()
    dense_lasso.fit(Xs.toarray(), y)
    print("Dense Lasso done in %fs" % (time() - t0))
    
    print("Distance between coefficients : %s"
          % linalg.norm(sparse_lasso.coef_ - dense_lasso.coef_))
    
Total running time of the script: ( 0 minutes 2.323 seconds)

![Launch
binder](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC)

`Download Python source code: plot_lasso_dense_vs_sparse_data.py`

`Download Jupyter notebook: plot_lasso_dense_vs_sparse_data.ipynb`

© 2007–2020 The scikit-learn developers  
Licensed under the 3-clause BSD License.  
https://scikit-
learn.org/0.24/auto_examples/linear_model/plot_lasso_dense_vs_sparse_data.html

