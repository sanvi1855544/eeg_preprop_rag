<h1 id="sphx-glr-auto-examples-neighbors-plot-species-kde-py">Kernel Density Estimate of Species Distributions</h1> <p>This shows an example of a neighbors-based query (in particular a kernel density estimate) on geospatial data, using a Ball Tree built upon the Haversine distance metric – i.e. distances over points in latitude/longitude. The dataset is provided by Phillips et. al. (2006). If available, the example uses <a class="reference external" href="https://matplotlib.org/basemap/">basemap</a> to plot the coast lines and national boundaries of South America.</p> <p>This example does not perform any learning over the data (see <a class="reference internal" href="../applications/plot_species_distribution_modeling#sphx-glr-auto-examples-applications-plot-species-distribution-modeling-py"><span class="std std-ref">Species distribution modeling</span></a> for an example of classification based on the attributes in this dataset). It simply shows the kernel density estimate of observed data points in geospatial coordinates.</p> <p>The two species are:</p>  <ul class="simple"> <li>
<a class="reference external" href="http://www.iucnredlist.org/apps/redlist/details/3038/0">“Bradypus variegatus”</a> , the Brown-throated Sloth.</li> <li>
<a class="reference external" href="http://www.iucnredlist.org/details/13408/0">“Microryzomys minutus”</a> , also known as the Forest Small Rice Rat, a rodent that lives in Peru, Colombia, Ecuador, Peru, and Venezuela.</li> </ul>   <h2 id="references">References</h2>  <ul class="simple"> <li>
<a class="reference external" href="http://rob.schapire.net/papers/ecolmod.pdf">“Maximum entropy modeling of species geographic distributions”</a> S. J. Phillips, R. P. Anderson, R. E. Schapire - Ecological Modelling, 190:231-259, 2006.</li> </ul>  <img alt="Bradypus Variegatus, Microryzomys Minutus" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">- computing KDE in spherical coordinates
- plot coastlines from coverage
- computing KDE in spherical coordinates
- plot coastlines from coverage
</pre>  <pre data-language="python"># Author: Jake Vanderplas &lt;jakevdp@cs.washington.edu&gt;
#
# License: BSD 3 clause

import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import fetch_species_distributions
from sklearn.neighbors import KernelDensity

# if basemap is available, we'll use it.
# otherwise, we'll improvise later...
try:
    from mpl_toolkits.basemap import Basemap
    basemap = True
except ImportError:
    basemap = False


def construct_grids(batch):
    """Construct the map grid from the batch object

    Parameters
    ----------
    batch : Batch object
        The object returned by :func:`fetch_species_distributions`

    Returns
    -------
    (xgrid, ygrid) : 1-D arrays
        The grid corresponding to the values in batch.coverages
    """
    # x,y coordinates for corner cells
    xmin = batch.x_left_lower_corner + batch.grid_size
    xmax = xmin + (batch.Nx * batch.grid_size)
    ymin = batch.y_left_lower_corner + batch.grid_size
    ymax = ymin + (batch.Ny * batch.grid_size)

    # x coordinates of the grid cells
    xgrid = np.arange(xmin, xmax, batch.grid_size)
    # y coordinates of the grid cells
    ygrid = np.arange(ymin, ymax, batch.grid_size)

    return (xgrid, ygrid)


# Get matrices/arrays of species IDs and locations
data = fetch_species_distributions()
species_names = ['Bradypus Variegatus', 'Microryzomys Minutus']

Xtrain = np.vstack([data['train']['dd lat'],
                    data['train']['dd long']]).T
ytrain = np.array([d.decode('ascii').startswith('micro')
                  for d in data['train']['species']], dtype='int')
Xtrain *= np.pi / 180.  # Convert lat/long to radians

# Set up the data grid for the contour plot
xgrid, ygrid = construct_grids(data)
X, Y = np.meshgrid(xgrid[::5], ygrid[::5][::-1])
land_reference = data.coverages[6][::5, ::5]
land_mask = (land_reference &gt; -9999).ravel()

xy = np.vstack([Y.ravel(), X.ravel()]).T
xy = xy[land_mask]
xy *= np.pi / 180.

# Plot map of South America with distributions of each species
fig = plt.figure()
fig.subplots_adjust(left=0.05, right=0.95, wspace=0.05)

for i in range(2):
    plt.subplot(1, 2, i + 1)

    # construct a kernel density estimate of the distribution
    print(" - computing KDE in spherical coordinates")
    kde = KernelDensity(bandwidth=0.04, metric='haversine',
                        kernel='gaussian', algorithm='ball_tree')
    kde.fit(Xtrain[ytrain == i])

    # evaluate only on the land: -9999 indicates ocean
    Z = np.full(land_mask.shape[0], -9999, dtype='int')
    Z[land_mask] = np.exp(kde.score_samples(xy))
    Z = Z.reshape(X.shape)

    # plot contours of the density
    levels = np.linspace(0, Z.max(), 25)
    plt.contourf(X, Y, Z, levels=levels, cmap=plt.cm.Reds)

    if basemap:
        print(" - plot coastlines using basemap")
        m = Basemap(projection='cyl', llcrnrlat=Y.min(),
                    urcrnrlat=Y.max(), llcrnrlon=X.min(),
                    urcrnrlon=X.max(), resolution='c')
        m.drawcoastlines()
        m.drawcountries()
    else:
        print(" - plot coastlines from coverage")
        plt.contour(X, Y, land_reference,
                    levels=[-9998], colors="k",
                    linestyles="solid")
        plt.xticks([])
        plt.yticks([])

    plt.title(species_names[i])

plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 6.607 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-neighbors-plot-species-kde-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/neighbors/plot_species_kde.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/02a1306a494b46cc56c930ceec6e8c4a/plot_species_kde.py"><code>Download Python source code: plot_species_kde.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/1c4a422dfa5bd721501d19a2b7e2499b/plot_species_kde.ipynb"><code>Download Jupyter notebook: plot_species_kde.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/neighbors/plot_species_kde.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/neighbors/plot_species_kde.html</a>
  </p>
</div>
