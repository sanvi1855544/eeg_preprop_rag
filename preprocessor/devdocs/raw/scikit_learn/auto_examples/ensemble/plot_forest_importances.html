<h1 id="sphx-glr-auto-examples-ensemble-plot-forest-importances-py">Feature importances with forests of trees</h1> <p>This examples shows the use of forests of trees to evaluate the importance of features on an artificial classification task. The red bars are the impurity-based feature importances of the forest, along with their inter-trees variability.</p> <p>As expected, the plot suggests that 3 features are informative, while the remaining are not.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Impurity-based feature importances can be misleading for high cardinality features (many unique values). See <a class="reference internal" href="../../modules/generated/sklearn.inspection.permutation_importance#sklearn.inspection.permutation_importance" title="sklearn.inspection.permutation_importance"><code>sklearn.inspection.permutation_importance</code></a> as an alternative.</p> </div> <img alt="Feature importances" class="sphx-glr-single-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAMAAAACDyzWAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAAWlBMVEX///8ICAhtbW2ampr19fX0AADxAAD/AAAAAADx8fEfHx/JyclAQEB8fHwpKSn6+vqvr6/k5OSJiYldXV3BwcHU1NQUFBQ1NTVNTU3e3t6kpKTp6em5ubmpqakP4+QmAAAO50lEQVR42uzdDXeayAKAYZDsuYQvDQgC6v//m3cGNYlp2t20q90mz3vOZq3S6KlPZ2BqO0kiSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZ+8LF9avftgX0//5HtMefaxJz3UfuF1as6zMvQ+tGO+/SffY13uP/akq9wvvC4jYPn9B98HuF7/2lM+AKhXI+AF4HGXplX8QdkVadFNl+k5S4ouPl5VSbLN51WR98mhStPd4WoKrvN+TIfVOnwt2uR06HD6hsnm8q3rvByHoVu+75Rk1ZA2beRcNWV1+mnJ46pIh7EPztsmHbo4th7CccX44M36pCPgeh3HtDbvNgFKeOeP9WZ7rIZ9sm/j/Ly/AliMm81+zsPXMT9cA2zaQ52vmuzQ5ZvzoXORThF5tQm8t/Ggoj5spjEPs/46WWWHbTvEb14N4aet8jn4a9JwxCocO4YbWdE8JFNabbZz9+jN+pwj4NL6abkOeVw4xGn2IW2fp+DXAKs4hw5jvKPZXQOMA9gu2lvHx7d5fHhKw88tmuVb7+JB9ZtzwPWcB1nVMg43YzzicJn+N3E0Dt/6GIZcfd4RcI4XIZeRsBsClbo4Xxi/AzAqO+THeGydP1xPweFmt9y3210OTaoi6U+3VuGh00EXgGE6jk9UxhEw/rgLUHfN+YV1Q3yOdfgdMaW7efJOffJzwDY/F+e+9lCWcSx8B+DxZdTM86crgPF0rUuXQ5vlHPDk6HKrDYefDjoDjLC2ZRafo1rYdUV4rur8wqrzc8RnHdP8dIKoT3sVnOXHcil5XKbJdf4CsFkANs8AD6elm3ga9yOA746ArwC2+bQ88RXAVyPg6Tn600JPtzyzPu0IOOWXIeZxuZVFgJvTCdkYUfT5M8DH4Xrd+jsAX84Bd8uJY5W8AHxYnmK/nDVeAXw+B5yv14dOvy30aUfAMB6twsXvqo4nZNmhHuIUPOXjNlwFz/nqkDXDM8BwR3fcHuvVjwG+ugoen6+C96cnrcPw2afVYVM11wDDVXC7XAWvx6E+HOZuk2TjvD28XHPrk64Dbqo0LcbwNj+NQzr2y4lfW8R1wPC/dLd9OQeMZ2VxZe74Y4Bv1gG3yTPAcK0T1wE3TVrUh2uA1+uAabOawrVKuKfaeK/0kbZO2gSgAJQkSZIkfZGeHvWVerofrSz+2cB5vWEXP9ebXD5A/OqDu0+5vlZ3E3hMs36Vnj6k1s/9NKdZkszpPvTqqMfcEPilBsD8bp/a3sU/h29efT5j7MIIOLw56jH3MfKv1P3e7/XycfFV9XxHOWRxCi6KsQQQwNtfXCwf1Gwvn50s0uXDauXcb8fzvJys7zsk64sBLF8DnPpsmM+3m/OH5OrlpBRAAO8yBb9g7EYjIID3vwipi8sjnXNAAO+2DFPHi9/NNGVpwFgfpr57/TcZAATwVp0XorswC2dNmu7iPw8VP0teuQoG0AuS9xtAAL0gASgAvSABKAC9IAH4vR6uPsoqAAEUgAIQQAEoAAEUgAIQQAEoAAEUgAIQQAEoAAEEEEABCCCAAApAAAEEUAACCCCAAhBAAAEUgAACCKAABBBAAAUggAACKAABBBBAASgAARSAAhBA/VcBnrfqim13Q9q08daxSZsNgADevstmhbF+7qc5zZKkzNu+/dnNCgEE8AN9s13r2J23Ch47AAG8dd9sWF0OYQQs4jzcFgACeOue8nj+97xLepHmcTBM5/BlTs9GP7hjOoAAfgRg+Rrg1GfD/AZgnccABPAuU/CC8WoKNgICeM+LkLpwEQLg/Zdh6sAt20xTlgaMW8swAN6r80J0F2bhrEnTXbaw/MBC9P/e9Fee//X2Pm8pgDd7QQACCKAABBBAAAUggAACKAABBBBAAQgggAAKQAEIoAAUgAAKQAEIoAAUgAAKQAEIoAAUgAACCKAAvD1Af4sdQAAFoAAEUAAKQAAFoAAEEEAABSCAAAIoAAEEEEABCCCAAApAAAEEUAACCCCAAhBAAH+m815xsU01pLtDvG/ZIvjh5wC+F4AAfqfLbpmxVVtOdVrGvar3oQRAAG/eN/sFx9vZ8AtTMIAA/vO+3TG9yOIUXBTjZbvgv9sxHUAAf76nPJ7/tc3zHe0Qpt5y7rfjeV5O6uWEEEAAbwOwvAI4p4fnuXhlBATwzlPwMd08P9SNzgEBvO9FyPzKX7LrAATwbsswdeA259l+vw9PXR+mvstLAAG8feeF6C7MwtVyuREkrop0qErLMAD+CS8IQAABFIAAAgigAAQQQAAF4L8PkFYAAQQQQAEIIIAACkAAAQRQAAIIIIACEEAAARSAAAIIoAAEEEAABSCAAAIoAAEEEEABCCCAAApAAAEEUAACCCCAAhBAAAEUgAACCCCAAAIIIIAAfh6ANhcGEEABCCCAAApAAL88wPNWXbFNNaS7ZbvWY5M2GwABvH2XzQpjq7ac6rRMkjJv+/YmmxUCCOB1V9u1Jufby1bBYwcggLfuzYbVoSIL/7XhRlucD/k3d0wHEMCrnvJ4/tc2z3e0wz5J0jmJu1ef7qmXTVwBBPA2AMsrgHMaL0KuABoBAbzbFHxMl2vfqynYOSCA97oImU/+XIQAePdlmDpwm/Nsv9+Hp95ahgHwXp0XorswC1fL5UYc+CxEA/jHvCAAAQRQAAIIIIACEEAAARSAAAIIoAAEEEAABSCAAAIoAAEEEEABCCCAAApAAAH8jwL8Ja0CEEAAARSAAAIIoAAEEEAABSCAAAIoAAEEEEABCCCAAApAAAEEUAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAD+S5236oo9dU2+Wu5b9ux6ABDAm3fZrDA2reZl88xkTvchIyCAt+9qu9YkqU4j4GAKBvAuvdmw+gIwL4rxslvr79sxHcDPD/Apj+d/bXMNsJz77Xiel5N6OSEEEMDbACzfAbjUrIyAAP6eKXipG50DAvh7LkJOj3QAAni3ZZg6civ7Xdf34bTvMPVdXgII4O07L0R3cRZeLjeKMCUX6VCVlmEA/BNe0C8BvN0/KC0AAQQQQAEIIIAACkAAAQRQAAIIIIACEEAAARSAAAIIoAAEEEAABSCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAACsC7APzhwQIQQAABFIAAAgigAAQQQAAFIIAAAigAAQQQQAEIIIAACkAAAXzeqiv21DX5abPCY5M2GwABvH2XzQpj02renTasztu+vctmhQB+dYDvbte6bBU8dgACeOve37C6aMOXtjgfcssd0wH84gCf8nj+1zbXANM5fJnT0131sokrgADeBmD5dwCNgAD+1inYOSCALkIA/OzLMHXkVva7ru+TZGsZBsB7dV6I7uIsvFxuxJnXQjSAf8wLAhBAAAUggAACKAABBBBAAQgggAAKQAABBFAAAggggAIQQAABFIAAAgigAAQQQAAF4P/bu+PmNGEwAOME3S4GEoVAAMXv/zUH0e5s57aXrViR5/lrXbme4s8AgbsAEIAAJAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAUgABCAAAUgAfCaAW623SALgMgAuUuuMLxqATw1wvj/9LN8aAALwS7UCEIAABCAAAQjAlwd4XaorVjXKbMb/i2t2bQEIwNl7W6xwrFNpvVHncang0xAjIADn73a5VjuuW502wwgYOAQD8CG9W7A6LhZ80PvhEGxM+7Za60JXTAfgIgAWejz/K138wY0LpVe6SLJjXbXX43Ji4wkhAAE4D8DsF4DXkz+XMgIC8GsOwTHfcg4IwK+5CLn8xi8K4MdffNP620yPzgBwhmkY62+mYWzf1V5nrwtwmtbH2V7xRLTPbyaiU6NCniUAnP1PA/D/XxAAH/Q6Hvc9ACAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQjAZwX4eRs/yxcBgABczrANQAAu6CQDgAD80ncIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCMB7XZfqir0t1ZWcnXIHAAJw/t4WKxz7uVhhpsu6XPhihQBcBsC7y7XGpYJbD0AAzt39BavNuHR6aa6bxBXTi93v+i5o0Ruv4B1+rHgYwEKP53+liz+40V2li0Qdh38c1WUTq2l9FQ8DmP0C8PQe4DgC7rqdvD8Nly+x8RreYfI8h+BPnbN5iY1X8A4fl+wiBIAAnHkaxvqbaZjq4zQMAAE480S0z/80ET3tsG73r73xCt4hERERERERyaraoMUX0GWjQltPvWIXbeqUanrpHy58UE447bS3Rhkr/MMm3tdK5buvFG+8S4e9IZ0qi/dTwyoA9vYgB9hu6ro1W+HWt4+O/a1DX9dWCW3vjM+6vhMSCYfurErZxqehXlfivZcZJwXoXdVZJbxnZt34StYyCMoBxs9I/Pnc3rURFTbCjyef8HrjHaIpt4lS+T3NnetzIcBt3MvSvWHdmo7C0wB2WjhOvbtvLdn+LB0BXdqGRog1KU2d1OEofn/7UIq39WkiBbjT4wlGI9wbVgXjOwDeHVGkot49OvbXaqWD9BxQKZttlNTUeD4lN5Wc5Y82nd1WDHCwV+yPWrg3+nPd5+EEwHsHqEIMMJsAcN9lNghHQNUkl6cwRErMuT5OGAHzVnwpNL5eMcAu17rxEw6t2wlD8XoApkZ8YJh6CJZ/mMbHS2zhxpsJX4PxDEO8Nw7Xh0GlN223xeW5pc/eHWsCOMHfP1yE5MJLhfgkhnQEDNMA2iB+CGBXDzVePi2V7KSXWfELbOwa9A17UZe1kFUaqtPpNMc0jK262mrhSWCmy+4oPQf05tAdgviznPqpi4epvu961wh1p1WXtWoVVyFVPIoIh57LIUf8LZ4wEe2NCrl4IvrglJO+inEC2Iifbep1PRPA8/AOU+kzfj4o09YJERERERERERERERERERERERERERERERERERERERERERERERERERERragf84ZRPt0EBaMAAAAASUVORK5CYII="> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Feature ranking:
1. feature 1 (0.295902)
2. feature 2 (0.208351)
3. feature 0 (0.177632)
4. feature 3 (0.047121)
5. feature 6 (0.046303)
6. feature 8 (0.046013)
7. feature 7 (0.045575)
8. feature 4 (0.044614)
9. feature 9 (0.044577)
10. feature 5 (0.043912)
</pre>  <pre data-language="python">print(__doc__)

import numpy as np
import matplotlib.pyplot as plt

from sklearn.datasets import make_classification
from sklearn.ensemble import ExtraTreesClassifier

# Build a classification task using 3 informative features
X, y = make_classification(n_samples=1000,
                           n_features=10,
                           n_informative=3,
                           n_redundant=0,
                           n_repeated=0,
                           n_classes=2,
                           random_state=0,
                           shuffle=False)

# Build a forest and compute the impurity-based feature importances
forest = ExtraTreesClassifier(n_estimators=250,
                              random_state=0)

forest.fit(X, y)
importances = forest.feature_importances_
std = np.std([tree.feature_importances_ for tree in forest.estimators_],
             axis=0)
indices = np.argsort(importances)[::-1]

# Print the feature ranking
print("Feature ranking:")

for f in range(X.shape[1]):
    print("%d. feature %d (%f)" % (f + 1, indices[f], importances[indices[f]]))

# Plot the impurity-based feature importances of the forest
plt.figure()
plt.title("Feature importances")
plt.bar(range(X.shape[1]), importances[indices],
        color="r", yerr=std[indices], align="center")
plt.xticks(range(X.shape[1]), indices)
plt.xlim([-1, X.shape[1]])
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.752 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-ensemble-plot-forest-importances-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/ensemble/plot_forest_importances.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/74c6ab6570af7f9379b15af6a1323943/plot_forest_importances.py"><code>Download Python source code: plot_forest_importances.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/5e3b69cd18b43dd31a46a35ccba413e7/plot_forest_importances.ipynb"><code>Download Jupyter notebook: plot_forest_importances.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/ensemble/plot_forest_importances.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/ensemble/plot_forest_importances.html</a>
  </p>
</div>
