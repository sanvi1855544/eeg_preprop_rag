<h1 id="sphx-glr-auto-examples-exercises-plot-cv-diabetes-py">Cross-validation on diabetes Dataset Exercise</h1> <p>A tutorial exercise which uses cross-validation with linear models.</p> <p>This exercise is used in the <a class="reference internal" href="../../tutorial/statistical_inference/model_selection#cv-estimators-tut"><span class="std std-ref">Cross-validated estimators</span></a> part of the <a class="reference internal" href="../../tutorial/statistical_inference/model_selection#model-selection-tut"><span class="std std-ref">Model selection: choosing estimators and their parameters</span></a> section of the <a class="reference internal" href="../../tutorial/statistical_inference/index#stat-learn-tut-index"><span class="std std-ref">A tutorial on statistical-learning for scientific data processing</span></a>.</p> <img alt="plot cv diabetes" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Answer to the bonus question: how much can you trust the selection of alpha?

Alpha parameters maximising the generalization score on different
subsets of the data:
[fold 0] alpha: 0.05968, score: 0.54209
[fold 1] alpha: 0.04520, score: 0.15523
[fold 2] alpha: 0.07880, score: 0.45193

Answer: Not very much since we obtained different alphas for different
subsets of the data and moreover, the scores for these alphas differ
quite substantially.
</pre>  <pre data-language="python">print(__doc__)

import numpy as np
import matplotlib.pyplot as plt

from sklearn import datasets
from sklearn.linear_model import LassoCV
from sklearn.linear_model import Lasso
from sklearn.model_selection import KFold
from sklearn.model_selection import GridSearchCV

X, y = datasets.load_diabetes(return_X_y=True)
X = X[:150]
y = y[:150]

lasso = Lasso(random_state=0, max_iter=10000)
alphas = np.logspace(-4, -0.5, 30)

tuned_parameters = [{'alpha': alphas}]
n_folds = 5

clf = GridSearchCV(lasso, tuned_parameters, cv=n_folds, refit=False)
clf.fit(X, y)
scores = clf.cv_results_['mean_test_score']
scores_std = clf.cv_results_['std_test_score']
plt.figure().set_size_inches(8, 6)
plt.semilogx(alphas, scores)

# plot error lines showing +/- std. errors of the scores
std_error = scores_std / np.sqrt(n_folds)

plt.semilogx(alphas, scores + std_error, 'b--')
plt.semilogx(alphas, scores - std_error, 'b--')

# alpha=0.2 controls the translucency of the fill color
plt.fill_between(alphas, scores + std_error, scores - std_error, alpha=0.2)

plt.ylabel('CV score +/- std error')
plt.xlabel('alpha')
plt.axhline(np.max(scores), linestyle='--', color='.5')
plt.xlim([alphas[0], alphas[-1]])

# #############################################################################
# Bonus: how much can you trust the selection of alpha?

# To answer this question we use the LassoCV object that sets its alpha
# parameter automatically from the data by internal cross-validation (i.e. it
# performs cross-validation on the training data it receives).
# We use external cross-validation to see how much the automatically obtained
# alphas differ across different cross-validation folds.
lasso_cv = LassoCV(alphas=alphas, random_state=0, max_iter=10000)
k_fold = KFold(3)

print("Answer to the bonus question:",
      "how much can you trust the selection of alpha?")
print()
print("Alpha parameters maximising the generalization score on different")
print("subsets of the data:")
for k, (train, test) in enumerate(k_fold.split(X, y)):
    lasso_cv.fit(X[train], y[train])
    print("[fold {0}] alpha: {1:.5f}, score: {2:.5f}".
          format(k, lasso_cv.alpha_, lasso_cv.score(X[test], y[test])))
print()
print("Answer: Not very much since we obtained different alphas for different")
print("subsets of the data and moreover, the scores for these alphas differ")
print("quite substantially.")

plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.854 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-exercises-plot-cv-diabetes-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/exercises/plot_cv_diabetes.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/428a26d23bc55d1c898a0e4361695ad0/plot_cv_diabetes.py"><code>Download Python source code: plot_cv_diabetes.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/27d42183163dfa32c3c487b21701b537/plot_cv_diabetes.ipynb"><code>Download Jupyter notebook: plot_cv_diabetes.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/exercises/plot_cv_diabetes.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/exercises/plot_cv_diabetes.html</a>
  </p>
</div>
