<h1 id="sphx-glr-auto-examples-neural-networks-plot-rbm-logistic-classification-py">Restricted Boltzmann Machine features for digit classification</h1> <p>For greyscale image data where pixel values can be interpreted as degrees of blackness on a white background, like handwritten digit recognition, the Bernoulli Restricted Boltzmann machine model (<a class="reference internal" href="../../modules/generated/sklearn.neural_network.bernoullirbm#sklearn.neural_network.BernoulliRBM" title="sklearn.neural_network.BernoulliRBM"><code>BernoulliRBM</code></a>) can perform effective non-linear feature extraction.</p> <p>In order to learn good latent representations from a small dataset, we artificially generate more labeled data by perturbing the training data with linear shifts of 1 pixel in each direction.</p> <p>This example shows how to build a classification pipeline with a BernoulliRBM feature extractor and a <a class="reference internal" href="../../modules/generated/sklearn.linear_model.logisticregression#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model.LogisticRegression"><code>LogisticRegression</code></a> classifier. The hyperparameters of the entire model (learning rate, hidden layer size, regularization) were optimized by grid search, but the search is not reproduced here because of runtime constraints.</p> <p>Logistic regression on raw pixel values is presented for comparison. The example shows that the features extracted by the BernoulliRBM help improve the classification accuracy.</p> <img alt="100 components extracted by RBM" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">[BernoulliRBM] Iteration 1, pseudo-likelihood = -25.39, time = 0.24s
[BernoulliRBM] Iteration 2, pseudo-likelihood = -23.77, time = 0.30s
[BernoulliRBM] Iteration 3, pseudo-likelihood = -22.94, time = 0.32s
[BernoulliRBM] Iteration 4, pseudo-likelihood = -21.89, time = 0.28s
[BernoulliRBM] Iteration 5, pseudo-likelihood = -21.54, time = 0.27s
[BernoulliRBM] Iteration 6, pseudo-likelihood = -21.19, time = 0.32s
[BernoulliRBM] Iteration 7, pseudo-likelihood = -20.74, time = 0.27s
[BernoulliRBM] Iteration 8, pseudo-likelihood = -20.47, time = 0.25s
[BernoulliRBM] Iteration 9, pseudo-likelihood = -20.42, time = 0.29s
[BernoulliRBM] Iteration 10, pseudo-likelihood = -20.15, time = 0.30s
Logistic regression using RBM features:
              precision    recall  f1-score   support

           0       0.99      0.98      0.99       174
           1       0.91      0.93      0.92       184
           2       0.94      0.95      0.95       166
           3       0.94      0.88      0.91       194
           4       0.96      0.95      0.95       186
           5       0.94      0.91      0.92       181
           6       0.98      0.97      0.97       207
           7       0.94      0.99      0.97       154
           8       0.90      0.89      0.90       182
           9       0.87      0.93      0.90       169

    accuracy                           0.94      1797
   macro avg       0.94      0.94      0.94      1797
weighted avg       0.94      0.94      0.94      1797


Logistic regression using raw pixel features:
              precision    recall  f1-score   support

           0       0.90      0.92      0.91       174
           1       0.60      0.58      0.59       184
           2       0.76      0.85      0.80       166
           3       0.78      0.79      0.78       194
           4       0.82      0.84      0.83       186
           5       0.76      0.76      0.76       181
           6       0.90      0.87      0.89       207
           7       0.85      0.88      0.87       154
           8       0.67      0.58      0.62       182
           9       0.75      0.76      0.75       169

    accuracy                           0.78      1797
   macro avg       0.78      0.78      0.78      1797
weighted avg       0.78      0.78      0.78      1797
</pre>  <pre data-language="python">print(__doc__)

# Authors: Yann N. Dauphin, Vlad Niculae, Gabriel Synnaeve
# License: BSD

import numpy as np
import matplotlib.pyplot as plt

from scipy.ndimage import convolve
from sklearn import linear_model, datasets, metrics
from sklearn.model_selection import train_test_split
from sklearn.neural_network import BernoulliRBM
from sklearn.pipeline import Pipeline
from sklearn.base import clone


# #############################################################################
# Setting up

def nudge_dataset(X, Y):
    """
    This produces a dataset 5 times bigger than the original one,
    by moving the 8x8 images in X around by 1px to left, right, down, up
    """
    direction_vectors = [
        [[0, 1, 0],
         [0, 0, 0],
         [0, 0, 0]],

        [[0, 0, 0],
         [1, 0, 0],
         [0, 0, 0]],

        [[0, 0, 0],
         [0, 0, 1],
         [0, 0, 0]],

        [[0, 0, 0],
         [0, 0, 0],
         [0, 1, 0]]]

    def shift(x, w):
        return convolve(x.reshape((8, 8)), mode='constant', weights=w).ravel()

    X = np.concatenate([X] +
                       [np.apply_along_axis(shift, 1, X, vector)
                        for vector in direction_vectors])
    Y = np.concatenate([Y for _ in range(5)], axis=0)
    return X, Y


# Load Data
X, y = datasets.load_digits(return_X_y=True)
X = np.asarray(X, 'float32')
X, Y = nudge_dataset(X, y)
X = (X - np.min(X, 0)) / (np.max(X, 0) + 0.0001)  # 0-1 scaling

X_train, X_test, Y_train, Y_test = train_test_split(
    X, Y, test_size=0.2, random_state=0)

# Models we will use
logistic = linear_model.LogisticRegression(solver='newton-cg', tol=1)
rbm = BernoulliRBM(random_state=0, verbose=True)

rbm_features_classifier = Pipeline(
    steps=[('rbm', rbm), ('logistic', logistic)])

# #############################################################################
# Training

# Hyper-parameters. These were set by cross-validation,
# using a GridSearchCV. Here we are not performing cross-validation to
# save time.
rbm.learning_rate = 0.06
rbm.n_iter = 10
# More components tend to give better prediction performance, but larger
# fitting time
rbm.n_components = 100
logistic.C = 6000

# Training RBM-Logistic Pipeline
rbm_features_classifier.fit(X_train, Y_train)

# Training the Logistic regression classifier directly on the pixel
raw_pixel_classifier = clone(logistic)
raw_pixel_classifier.C = 100.
raw_pixel_classifier.fit(X_train, Y_train)

# #############################################################################
# Evaluation

Y_pred = rbm_features_classifier.predict(X_test)
print("Logistic regression using RBM features:\n%s\n" % (
    metrics.classification_report(Y_test, Y_pred)))

Y_pred = raw_pixel_classifier.predict(X_test)
print("Logistic regression using raw pixel features:\n%s\n" % (
    metrics.classification_report(Y_test, Y_pred)))

# #############################################################################
# Plotting

plt.figure(figsize=(4.2, 4))
for i, comp in enumerate(rbm.components_):
    plt.subplot(10, 10, i + 1)
    plt.imshow(comp.reshape((8, 8)), cmap=plt.cm.gray_r,
               interpolation='nearest')
    plt.xticks(())
    plt.yticks(())
plt.suptitle('100 components extracted by RBM', fontsize=16)
plt.subplots_adjust(0.08, 0.02, 0.92, 0.85, 0.08, 0.23)

plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 12.629 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-neural-networks-plot-rbm-logistic-classification-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/neural_networks/plot_rbm_logistic_classification.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/74cf42fe2afd38be640572601152dbe6/plot_rbm_logistic_classification.py"><code>Download Python source code: plot_rbm_logistic_classification.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/64788a28f138e0d4ba98dbbbb9116be5/plot_rbm_logistic_classification.ipynb"><code>Download Jupyter notebook: plot_rbm_logistic_classification.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/neural_networks/plot_rbm_logistic_classification.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/neural_networks/plot_rbm_logistic_classification.html</a>
  </p>
</div>
