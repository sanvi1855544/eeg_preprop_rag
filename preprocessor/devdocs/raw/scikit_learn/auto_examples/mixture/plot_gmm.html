<h1 id="sphx-glr-auto-examples-mixture-plot-gmm-py">Gaussian Mixture Model Ellipsoids</h1> <p>Plot the confidence ellipsoids of a mixture of two Gaussians obtained with Expectation Maximisation (<code>GaussianMixture</code> class) and Variational Inference (<code>BayesianGaussianMixture</code> class models with a Dirichlet process prior).</p> <p>Both models have access to five components with which to fit the data. Note that the Expectation Maximisation model will necessarily use all five components while the Variational Inference model will effectively only use as many as are needed for a good fit. Here we can see that the Expectation Maximisation model splits some components arbitrarily, because it is trying to fit too many components, while the Dirichlet Process model adapts it number of state automatically.</p> <p>This example doesn’t show it, as we’re in a low-dimensional space, but another advantage of the Dirichlet process model is that it can fit full covariance matrices effectively even when there are less examples per cluster than there are dimensions in the data, due to regularization properties of the inference algorithm.</p> <img alt="Gaussian Mixture, Bayesian Gaussian Mixture with a Dirichlet process prior" class="sphx-glr-single-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAMAAAACDyzWAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAADAFBMVEX///80NJkZGYxVVap/f78AAICsrNXx8fEAAAD/jAD/2az/1wD/3zT/8az/ozT/6n9kle0QEIf/kxAAv785OZwfHx//41UEBIK/v78REYh/f3//2hn/slT/jQOfn58jI5EKCoX/myLf39+/oR8CAoFfX1/N3fn/kAoKCgr//v7/lxkGBgaDqvD/2RGs6uo0zMyqqqo/Pz//pTlzc7n7+/z/1wT9/f7/xX/Ly8tqamq/oSIODg6/oy0UFBRLS0v/jgb/2AolJSW/q1//3zn/lRb4+PgJwcECAgIaGhrj4+S/p0qYl5htm+1pme3Hx8cwMDDs7Oy/oie8vLyMjIwRw8O5ubmXuPP/wHT/79z/tVv/3COlpaVkZGSysrJFRUXYjjvExMO1tbT/6HVpabSvmTpTU6mRkZFRUVHo6Oj/+vNU1NSxlip3d3crKyv09PYZxcUlyMh8e3xVVVXi5/cDv795pO+fvfOpjy3/nSemwvRRUag2NjbU1NSB39/fjS87Ozv0+f1f1tZxcXH/uGL/4Lru7vL/9ulzn+6Hh4exyfX/umi8mTHa2trQ0ND/vW65nCX/rkxiYrDQjkZYWFjr8v3/1qT/qUJ4eLvwjg/ApDyqlU1q2dlxnu7JmCz/yYdZWaqSk8g7zc1DQ5/Ij1T/6M3/oC3FxeIrK5VdXa7/0ZuAbD98fL7/5mO5udyZ5eWZgjb/zZH/5ceNeUly29vY9fXojCFcW1zWlB+JicTgm0usrKz/w3q90ff/4UjI8fHUuDyPsvGwsLBLS6XKysrF1/jU1OmDg4OLr/H/3izmwhD/522np9Ln+fmhlI573d35jQa67u4MDIXJsU+qlYLVtRz/987JycmGrPC0n0ycnM28lG6Hc0HRuET/9Lpzq2+IrvBI0dGPjqr/7IiApV+Fq/Dyzxz/7553cI/w1EzdyW7rz7T71Q/wmy9lVk2NsnmQpFhbr4LgwzZLQF4WE3U3LmViq3VVu5vbupl6l9N+lMYguahGPnArKICVrWyGvZI0GapNMGQ6AAAgAElEQVR42uybTUgb6xrHx5mMDkSRwMQ4CiYYhUgQFD/QfIhagjWCNhY31ZbWb4gVbBcBLQgFL11URLoQ3SgurOiRgItSDhSxpXB6ShfHei4tuuldnHIpXfRjd+/iPu+bSSZRq2lvz7nl5v8TMpPOpAydX//P87wTBQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyjNk+q9vd0teQ9gcKlcLTDhcpSinbjnuVckEoVUqSD14rwj84SKGj7fpwd/fwtHI33U/kdOacLqB3gm1L3G4SMNA5mnywUcG/OEjmaltTgO9UtX+nv7FI6bPW03b6nqv82MGTBRzHfchYmtxJCdVwz+q23ivlFvEQY8W0u9rvto6QIx1dLlfLmF6CjVNLlMJGv3+k3RCwU+kRhLtKt0svwYGuFsrMUX91bbnCKNXrslLEzm4Y8Z4XKjq63N6RUtyPTKPWNZ30rqpot7Cq2n8hWcBS95Xdwt4HM0Kv0tjT3XFbF9A4tUSxNvaUeKsNAS9M3xCEMWtFXEDhrndEqK/2jwp3byidnZ2BFAGtY927Qp/7dk9vi38UdyTDGFXucQ+JCl3JcddwsoA/K7N69fQeHUJip5YojbR/URk1BCxxX6g9XyQkBBSqlOGitp5ECU4RkI0lncpFem13jeGOZKaAXVQYSYHxsZY22mtMFvCue6qkNPbm3u6FhIDGqSWs4Ao9Sqch4Lh3+DJ91BBQaHS3TQgnC8j8nlBG2f+BqSnckcwswbcaLjMBm1x3up80+MtTesCrTS7FOszeTbcpUz26gMapJUpDytoMCSj0dY1cEZIFbFBiveYJArI/71NiWHFHMnUIKSUBc3g5DLSRN3eUAK+rPPtqOx8ovXxavTblLuWuJZ16koCdSltvsoDjLS3eJkPAUaWDXi/EBGSpOqZcbWDM4oZk4DJMrSHgHdobZuvHvcoT2q1W9Lk0R9G7s13lmi5g4tSTBBT6RgLJAj5w3fqZt3m3FbbkUuFu5PmaEPCqUoVbkaHwhejC3hEWStX+ju6J817yJsd/fffyiJUE7LhRUnjtBvV5fY1VhVVd3tGYa8apJwrISQjYwV4a3X/n0nU2BGjovdh957ohoNDnGrtc2NvYgfuRecyWs0dx5d1sDB3xeq/csrL14yfTrvNFrAfsHLG6/dWXyZ1qv/v8jVndNePUswWc5SvSgS7rjBDo87MndTl9fldTaZKAQsmUy9VS3oDbAQAAAAAAAAAAAAAAAKdT354DMon2+h9LwHYFZBbtP5aAOQoiMKMCUMn50QTMQR+SQeRAQID7DQEhIC4I4H5DQAiICwIQEEBAXBCAgAACQkAAAQEEhIAAAgIICAEBBAQQEAICCAggIAQEEPB0srOycaMh4P/ugrLkLOgIAX+UBEzVEUDAv/iCkIAQEEMI+H8WMN2MSzkPwQgBv9cFpdvl2WVb9vEPwUQI+BcloF1OMjXxIQwpEPDPnTpqHDX6Abs9G0MKBPxTLihJrqOR5pAdR3SDcxDwe19QllFeDb1qZ24+XVuTbMtra2tPb848pwPcTlRdCPjdLkjX7Uh5fX7/YfZKzcD8+vIQR7Wo6/OaLC6I9uxvHIfzcvOgDwRMYwSumFlbEeUyVZofGKhZMHFEWawZWNVUi1w2+XxtPNm6NOMwr9mcC30g4FkzRP3NTXF1SFotk0VTEpIoxbZlsjY0NPD6vmFdmgmYa25GAkLAM6h/ujJvkbVNk0m1qSf5pzlsZermqmYXF8a/7q9GBYaAZ8Vg7drD5aGBIS6bmJKA8XeiTJSxt/OTNVuB4wGI+RgCfm3hZeMH7+NWRFWq4TFnkYzM41v9HQWgxSbb+NvN9aHNp8daQMzHEDAt/xyGKGwBhnys3dL0mNPkpPRLJCGTTpQ10SFb9EML0vpWPRIQAn7DBWXJjpQEFISbD9XfLLHQo0lX1fPP6P5IvjJNFemYRUp0hpr6OgAlIOB/PfoKFTcXJpOzLiX39D0bC0Y2BScmFArEyZXnyDwImL5wXyiR5N+m4VpK7mmipPeBFk3i8SiZWB9I56ia5fGkHV0fBEyj5GadNiQETJObJyy6cOksskh5yP+IXiRLmWyT7LKdd4eibFu9H/+qAtZaIOC3JuDW0EKye6Js0WdfTbbZbWq8JpNvmkwGWuK5SGWZusIsw7tcPO2AgGe0eycwXrOeMvQy8TQ+9Fqo8ePtIOv6WPpRIjrYjGKhE1Qu4WPtdcK7vEuXkIAQ8AvV98uGTmqTR6qvRIaJ7I1KAjoktjSjkY8Om8qlFPkJNq7m5tBaIgERgBDwqxMw26GblIpuIn/0QUcdsiNmpfpp9e2/Jl68fLkd3X5Q9OJFx5vl5/11xXlHWkDaQz8IAdMhS3ZkadIx/dR4FKrsuQgNvxbTm7cf3x9Eo5FDX8S3s7O/v7/DcX4wm82/VKROIpSFehzCQwh4WjJm2+3PBwaO+mczUlFylKkm09sHS3uHkUgkGo0eLG1sRH3BoG+RvQR94WdMwF//+D25EBsJiLIMAU/rDWlTO7AqSkboxfo7VV93oSL86WPr3s7O4d7eBjEYjoQHN+acIVLP6fM5Q54IE7Dyp4KCSnPxCWsx/c39sAYCfiEBs7NqaPOaTRwihZ5F/yKMpqtIM/GbiYOI73CvlXFAAoadJF9ryOlxelgChpzhuXckYHNxQX+zufmPX+O6YWUGAqYdg2uqGPuJfR1Bij/7MK1+3l4MLzL7lraXgr7BMP34QiRgkLKPNq2tPmdkn/SrrDTXFRQUP8ql/UQTKAjoASFgGjFYPzMwLyZW+/Tos2iW5RfRSDi6ccDCb3tjO+RkhHyLoRAln4cLGAxF5t4VF+TnF9SZi/Pz84vN5kcV/MvP8A4Cps+W9Dj1W6iSpezTx2h48ODgICYgJaAnJqDTE3JSCtImSAEYphHkXPG5Yoo/0jCfQrAgryK9X/+AohAwnoK1K5MLicU//tDD9vmAwm9jeyM6NxdkBlLR9bAMJA09Pmr9nNQBkpfhD3Vm9sPijzhXd+5R5T+OuXWia2gOIWCiD5wxTdbEmz/2VZd/v49ENqLh6NL2HKu6wdaghzY+DxfQyQQM0Qy8GBn8J4UeT8CYgHU0D+uz8JmuIQEhoJ6ANAmPr6iaxL/fIlts6otX4cW56Jxzjpq8UIh1ez5WeZl/i7wOhzyLQd+ryNwz1v7F7aO9SyRg5aO/HTUMrkHAUwS02ygDa+2yNkkJKH9+//bl4SEZ5wv6ghR8bN718LesAoeCi3ETI0s772j2za9kazDMQjaI8O3vMediuQf5IOCpMzD7nRD2/fzs+5K0vmCyv98Y3NljyRfkqyweNvEutnq4hKwH5I1gaC4S8TyLzb6VbB26mNyj+nuON4K/5PGqG/tuTMoTOdgIAY90f7HfCeFi1K4tDC3XvI3s7AVpzPUwAbmH7KEbTSAsDtniC+0PRiLOD+8qCwqa2QRS2WyupOQrJhHZLNJfSe7l9sfXAlOeyGHwgIDHEjBpShjfMq03hhZb2RM2p4+Nvmza4KWX12BmYOhVZOnV3rPmZtKNhZ85Vnd5B1jHEvCnRydVXyQgBDyFhBgV7fv7kaWl8KtgfPT9D3vnF9LGnsVx33bHv0MGwkKaC6GgREzClsYLyy4NmxLobvJwIUwvvrgbfDE+JGCS2zwoCbs0hMIWxIKt6WWD24cLIndRKYIWHwRbaVVoi0VWa2tb2m5p+9Leexd22XN+k0lGq63aeGvN92tMxoxKJB++53zP/Gb86qgYOpMN/ubo+a6Oby51Hb0REnXXTQZIDugpZmALt4Qh8wpWpgLA3dEXEhVTbD70Wp4++/29S0Thpa6u8+fPnRfq6Lr0DanrD8+e/Zs8z8t9H+cPLrrU/2lRWLSE5lAnai0A3I1qazz00cYLqNpqHB6Ph9B6fOPOv357sUuITO9e1/mv7ty5cYN587rdXHgdfPjD4SjMYSyi/aOt4WGxLAu1FgDupOIaHLCNl5C21Yq2jh3Ny3YWevr48eOnTx97HQ6t32PgGrRNrsHFKaA+DBymAtxW0wZOAOD7Pc+4VKWYD+hmn/J43GKaIho68Sg6PYuZ7t0ejU0Lp98avf7q8NEOh3fFvj2AsEUAuIkEcdG+4jlt9Kz9obmwsMVcWGDgZdTIAc0O7aHQ8jlq3GIJgvBGSyGD1NS02avqLO7Q1qihMQSAm0n0aMvnS3yseLV5Mrd3jBrFDY/b21AYNDNqmuF53ZpNOsRiVAHgdfd1bQRdPB8EDggAd9ENiu1Oh8DMq833vJZC38d+SHvc2qivuP6PnbDGIZ5w1Fo06vgcOaAGAPcSR1gNogd0a9xRAyj6PrY8PuDGLij8zsJ9obdBc0q+pxj9BGchAcA9x5EiinXMWENbjYUXWVGh1QgTK61ER+gpWZ+7sAomNExt4HUsfQGAuzC6d3boR8/aatwe75xFm7MQWHrM1Zq+Bp3HBrNHtIoW87DZPDdXxA/8AcC95M+6wrEQHgXWnX1o5kkL1WKHCLpu/VCHmAE6DGO/EH05/ORuJ6IuANybA+rSZ3fiLN66WqKu1lE4z4P7PU7E2lhQA5DzcWjObDZPWRo6EXUB4EeJkdEB5GV8VIU9NdfrQsTX8Fyh3+P4IQ58iAocmnJ4aWdDHXtfnX4YGVUYAO45iBQjCC+lsnim2ixtdXcbLFPDZi+x5nVMTXn48geUNhyCy4dPVgg+8VOFmmsovajCAHC3DrjBv8RhYYKIQDp7l/Lww9DcnINawutzIbMltLJy96zdQFrhcF6o9BtwNQ4AuPdxjEZkHVtg6Uix3S6wLF4Cy1616QpsGxbe479yAcC9uOCWSGr2GCqZ5NYXfdmw8B7/lxAAfhx8m5DiBYO1mztGfdHzhp9+N5BAAPBD0L03M5Qc0LB4S6NSH1zD7QDgR/V87/rVNg5GP6Tli1JsEYNrUAEAy1N2t/FEw4zGw5df2/HvgQBgObpCA4/vmbDgxEsAuE/aGVQ49RwAflLBAQEgBADxgiAACAHAw/6CcPkDAPhJX1DpYAgEAOGAABAvCNqtnC7n7r8TAELlkktx7ZBKw3cCQKgc1secGVkT207XqCv6ASoBIPTRiirRze4nvnYpPtrjRA8IlV/21M2bYyPRnsXF+UhMicxHRwzextbnLD4AQKhMak3dHLtGxAXT84OD6XQ6qMRc4aBC92vhtGCNzFD4n8/5ub7fAPAgmh1h53SOMHXhcNinKL50enAtEg6z9635fK7woFMrwhqATt9WnR8AhPbA3UjPKJkdcRfOE1aj8/M9DGAkHwkqkdG1oCucHhxZHEsVi69z2+wLAKGd1Vmdu7yPzY3MjrHrIbtTlHBPTw/VXJYvmE8P9jh7dswaAIS2m6IUGjwBnuZ3+WA0yKRFwpFwTzjoC4YjTF1knrgMkgcqscHFazePbzP9A4DQ9qqur6abcWQSvbY4ko9FGbp8VIkFw2xzMSVInkcUBiOCxLVgPi8q7vwIxZCocyO+ABDaqeqleroJzxuJRAbTPiUSdOWZMSVWqK4MoC8SJhgVn3gipkSZPOfiGLvex9oeAKxE1ytt22ynJ/606OwZJfaUGH8Ks/ORCWoExqjji4RHBxVdkajiGzkuokk5bA8AVhp31U1SPXFXTdF27Jrzv6uv029fvw2uCcJ8PsoTQX6MCRp9LkIxH8xT+qA90XAkMupy7mKwAgAhY7UVHd9JyXpyYeDqxT+/fPXq5f9evnq5ur6+rgTDIk3wJJnh06pvLJoOKpEI9YVjNw2HMsrneQCwAjyP76vrL5z9vrm5WbKaJILv6mXSxctXaYM+O9bX31C6EB2e1uUFoz6Fgi+RNzaiLS6oKmuzBwArxvMuXPn2jGT73iQ1nZEkqYngu3yug3ROE/N37tXq6pv/5F2+QuiIBeevjQnYNjndfhkfADyEznfB1vxl9V+ar1gl0zHTsWOS0MLljiJ8dE8ueK5jffX167dvVldHnBRzOV9EFZez5HqV/X4DwN2j993X/6y2SSarJJmOsOlJNqvOnzQgzI8R5BJM9N0Tm1dfvKBIUlVYxke3fa+1APDwyd759T/+eqF5ocl0xmSSiD/pzJcMXZNk0MJAUd9e4X0nm04TtDYxCfwZay0APAxqbGmsqj72vP/5xA8/tLf39vZOTEz0tre3DxRosx55B0ChejLHKm0CqA9mjMdC8H4DwA+SN9M/Gc/G5b/fvr28PNQn6Gtv7yMNDQ31CQCt2ucJA3gm25EzVyRTNQFoO5h/GAA84Dqe6u9ubEzKsj/x44NbX9weYvIEfO2Cv6G+vt7xBclgfFaxfdJEJDbpLieG0AAQAH6gupYeW2dysto4M5lMzvrj/rgsy9O/Wm7vHacPnT12PoJvoGh3bH1Wq+lIc5P1NNfY0/XVB//PBoAHRS1yC+eKVIscb5zMJv3EnPooEPDzhvwTOR91e73tE5rtEXtE44sFQ7W1Ss0m68nqz+3PBoAHRK0z8WzjTDaZuO9fUtVEYpqKrmAvwHe3+8bHe7W80T7ROz7+YoDYs51ulkwnmkwnRMiw2WxUc6sAIADcZeWd7O5uTOSmE0tUa+8nkslsVs0sZZbkkn66dev28tDQsrC98b81c7VtvvJdJ3V2Nl5a1cTH3Sho8IAFAALAnXpeqrs7mfHL/iX/o0DB6gKEnqrKRgV+fPDgj7duLVMNfn7sJI9UeJgiQoW+1OBgDVYA4EHPGnYOtjNqblZV/XIgN52T/XKx2Mrii4C/RTxD2+py30TvgM1m5UFKMVmIFaWfJ3IA8BPOVPq747KfyKN0QXzlZAoZKlVc4iyjO16h81PjxGZ2smVGX0G/kbbDwB4A/Bldr5VNjyKG+sgfkAPJXKnE+jOEoNjSGPTPiu3+FMfi1kPfiADA/ZY9Ra6XmRbZdjqnqpmA7M+q/oAY7sk8ZsnNim1/UiVbDEymGgnRxtJgEAACwL25XhXb3mQysRQI3M/JOcIrIGcydLeUJSWTiVlyQ4og1ATGs5nMDNldYzxeMegBwH0Vud5kctb/SE3wTJmMTxUVNkCtHdke2SHtyE5OB9T+/pQBOG0cXUECgPsxYOlvnCTM1EROzmS55so59ju96cv55Xh3d3+qVeNtg99VkvkBwPLWXFE9Wf3ZxLR6PzedTE777/OkhUpwgvwuEVczmQTlWqKsABo/VJzpAcB9UYusg9RNYVdNkJJJqrLJeJbtLtW6weAM1FWc6QHAfcgbRgesmmmZpM4ulTpemqK0buKusqkDgGX2vpaNPMb5Cfv2rEIAsPwOaOAxDswA4D4SVtbvBoAAcEc11hBbt2QM2AHAfTM9bVgiCqvW720xOansYQoA3OdgUYwWcEAA+KnaPiAGACEACAAhAAgBQAAIAUAIAAJACABCABAAQgAQAoAAEAKAEAAEgBAAhAAgAIQAIAQAASAEACEACAAhAAjh/QaAEACE8H4DQACIFwTh/QaAABAvCML7DQABIF4QBAAhAIgXBAFACAACQKiSADz1C6hydOqgAXjql1Bl6dTBArAVBlhhFtiKPgSCIAiCIAiCIAiCIAiCIAiCIAiCKk5f8NHq3/36/+ycz2sa2x7AT01NzrbQ4RoXE5ErTJiNQyQowwizCDNBGIMyKyeilKsuVNDuakAQAlnoomRxl7d00RYedxuKO19p9m9TeP/NO98zM46jk9SW3Nvmvu+XksTMmZnvj898fxwbz7/hFCFz//FOt6zKZnuR2/qKNHnf0QSlIv9BocLG7S+S6W83OknZl5LoXjx7v7HMPap+Y6/rKdLV+2akO2zpJxN/dQQTNPG4ARQta67QbyBwNr33sKVpg2aiNjTEra9ond7vYXUM39NUFTZun/0e959a7EtP2QrAsWVVWmPazoX17Fgn2wB4dv+z9RCyZ+09bgDz8KDK1w91wUtN6LicJh7sEXcoQDcwi8LGwWgAc1tk3y0BLHo5sxtKbIfhVd8FYP8hnBNtaf+xAXioQl1LjlS1LDLfOiq3QOmxI6WyrLah3MyKmmwWT90aeDIpq+powT1eEHWpvMyg1dWIdgo9SVMay0KRhmKavjZlTZkRUlE0WWj33aAFS9O0WhWkkRUAmBVY+I+FQdEvwY7MtD5WtA7vINhF3bqsKLBanJj0gl1clcYV7xKHWoHFSqXs0agal7wEQ21lJT1BawNTrS+z6jSjS2Zxtg4g6Uknrp4itTMaPXFLsM1uol8BgNOiZE5OfAA7jikLyRwzBSTj21GbaDIYztbP6tKInBXYsgGcddxibub+zI4kqQ5rNt3kKTTvyUKLLC11PbuA0yz+qOTbqvmYALRyudOJAU1ORqxUbiXmwBktQXsFXx15Ytd0rUP62iibyBYuXAL2MrWEPeFVlgqjbFMx/Jaobqw8ftNCNtF0jEQIQF2vJeaTBEnL9UWidnPpBi1YmqZCfbHoqXsBgAMzR2w6XQJ4UhYYRkzpzhUtWVYnBKA5PG+e1Wh7fl40fAKvdVZAqVQjpDhye8CZULasGVsu3DRrgu4nksZknli0pek6gF3a8AE0HXue4wCKVKlVSoztjNyrVpKcPf4wCUKpcitnyIlNHcua+nYI7fOarqZhvXBVsU/KUtUeGHCHG+os7FuG1S11mvOxdBHlJlchUxCbN7S6tJR7tkbri2xZboBtQreyeGRDCJVL3svj3K3GUqBSZj8XWB60wFJyKnVJni7WhpBczoFlVGOkdIwr76huutfJ5Y79ZfX2KoBntOUemNPZWtlyl6Zpj+HwidYCANO0SYYKWQJIpmq7YgyCErwKIJTWvgZhPS6Plmaeklu9mCE5aeANIX4JLvKrWKGypk/WASxBYncBzPhDSF8de6U4w9N+UfdscaQ0rwUXoRKcoGW2PC07sF70r0muqE0adOB1p0YBtDeHUW7ypiJ4WWexcS3lnj02e8dg9BhsS5LHJGwIyedth1tbqatAYweMbpA9ifliQDsMpdxoRPZUvXQRAJgdSwAueJy3j2YhBOCEHYTQsQLOftJXATzUzeoM4JzKIzEdALhcmub91gm9CgAkSvtMFlcAZMjISi4aQG4KnYPeXeqlY7ixUmiZrh4hAOHZmy77htxtD9So3wPgwgfQXj4jGQp1tCt7tphFuDlUkDCAVa6kDushvQ8l4LfDzO3Sjn+bPJx6rUW5yVWo596+4VnKLbpwL11g1ScZ5vWR9ICkLl2SL0Y928gPoLYcC9ekBZ2/4/1ZAYv87FqlJutreLDndLiw8g7lPWBob8Ytwaf5vFmEJFBoWvm6EO4BHY1qBRaBRlGivJuBKAVL0643l6EDAGvygD3zKwD2NReECACBpdr630PoN335/IJOB9DLhQDM+noRN4Zd+0u+rNxTgj/5ANbgdytDCL8srDG8m9+uAch5vVb99XWd/95wiGN4qfTWO9OIcpOrEH82bGa9Nz+BZxvupW+ZuUmf5ccFYJd+IRMZHmMOIKnKHb3u+j0Pwp+qw9kE0hIEuy0c8s5lE8DlEAKhcwM5FqABgy4z7wV6esu8DvnGugHXQZSCpVEA9lU4YQXAG6knnAUA6tf+YOuGxaYtrnfe3yxxtKaxR8zWuE7uBZBPY8RcB/BwZQjJR2TAMIBm3b356Z0ZkK+PzIBz99QoN21kwGxkBjx7lBmQ+XMisfTWFziAl5LCM0xjbZdCHXoAwsPbkSIAXG7DcAAh3DNDADdXOd1+oP3ubA/qLQdwuTQKQFJtz1YBLFExrbJ+kZyz7hD0h7BMjSWAfbWwvl1TZw3SjWJUfVJcDdYB1CDiTapsbMMMyAaAfVU5jATQMX0I9la2b1Z7QMmjjT+xlaAHTC976Qg3bfSA2aAHhEt7PeBjA1C0rKZD29A3De1aWXe3+AtU4EOEI3XPE7VCiZwXSxW7AB0TECDSQkXU9QgAYSM62WwsJrC1yDriSsnUBe6ykt3VWaBn45ZdGbAJojQUE80hZEYIWrA0EkAuSwBnEm8DWrC43cifsWoI+phLAEnNuM4m5oNCsCHn0sPDx0nJyNlPsw0AM3KrUtVWMiBsRJfGdJjbBJBPwQk+BYcB7Ah6qdIs8T0r3c6ngym4yabgqb/+pKyy2Vn2puBz+4rZc2U4i0R2koxy03IKtm+gEq0AyOwvLrIjdwp+bADCe03lKpQqUZeFK+89poQ/A4gjSdIzeTK91iV1JPqsXQlyr5SMAhDeipNksyjmYLvQlMuLDHDTGWrqDZTgTkaXpHIrR6y2ILtvAkLQgqVfB7Cv96DRLMhfCGkJBkw2VUEeJYIekH3n25ZB/i5Dw3ZKYcZ3SUmzkUvYAPDS0aRxQ1FW34qTVt+KWwWQNBVJ6l1tAEjOJsy08oApWWGjVWgfcJwPNq7PCqYhdN19wJ6sjsEXC0WVhWElyk0r+4BVEgaQLEayVG+QxwfgXTKR/hl2/ETytTddthN/KvpniyXKEyQGAfxhQqVhH4lBAFFQUFBQUFBQUFAeRPDj2fDj2X6o4AdU4gdU/lDBj+jFj+j9wQDih5T/Pwl+Sj4KxhsBRABRIRSMNwKIAKJCKAggCgKICqEggCgIICqEggCiIIAIIAoCiIIAIoAoCCAKAogAoiCAKAggAoiCAKIggD+zQrtPdjHQCOCPU+hJ/AniiAD+LBkwjCMKAvg3K4QZEAH8GRVCLhHAh1JoW5aOUkcRlRlJRAAfdOi4W1Lx+O4mtdgjIoB/VwaMR7GGGRAB/Gu7u6DysiOIGwL4lyi0e3Cwe0dFTsVTa+UaKUQAH1qhJ0F5vTMDQgLknGLbhwA+mEIebisZMApC/ppx56IXOrptOsS0iQBuNQJ7rKV2N1YtM2CIpi3T4W4K0yYCuE1icllbw2Vl04WRufvkIDi8ZWZbRxoFAbyPyNCm8xKy3YPYr/EYg+ngm+spVmAE8G40NukIF1b/FRtV4s+CB1wAAA8JSURBVPFfQjCFT0XMEMBvzUdQbUObK7zPW754spu7fPnm/ceP75+++xjbP3gf//cWpKIggNtOBNCc+UMu/8XBckfm5PO7g3jsxesPH/7Y2Y/vv3oWT/0nHo+92X33+WXOIxYzIAL4PaNvMBGEEp8L4C9HLO+9/PPNiw/PU6m3L46Ofv/9X7/tp/afx57F47++3Xm+//z10X/fvcd0hwBup1Dktt5dXR87yKaMow+vdl4cxeL7sZ2nXGIs9z3dScVTO0/348+OXv/26m3s6HMOcx4CuE3G+/r/nQoOXf75ClIcULfDcl5sJ7YD/56l9ncAw/+xd8Y+bbtNHP/FjpHMEOl5ZMmyZMuOZMmKRwcpY5b0b0gyRxlYunSJWKEdMkRhIGwUoVKKEBLdKrEhderE2P/mvbvnseNACqGFF2jvBIljh6qIj75333vucVxTWAIvXR1F0VbIMsgArq6A95kEeOO7H0fihGTPNBxCz7AM+EINNIBCyxKO69AroNEL46PvG1wCMoAPdr+/kMpwd8uzXOQNEHMtVzFIyJme8CzDs2KBiRlF0RNAp/j48WTtlrfhYABXFaXSWw4NZ0DKB9zhs2tZxCJ4YErHwgP5A/wQQUfLpNkUVvjuprfhYABXSrrldbWNtV1zP7ccyF3VAQDBdVTBe8CpCPSQSkKCUckkMiiuK4PzjTLJPDnIAK6ogJA283W1Nz+Hg6oOU5lfw1ISiLaDDAnlYkLTDbU/NmMrHu4OD98uYs89aQZwFTDnaXPj51azwE/lVzyIYkfzGFquB8Jn5h6kmvtk8CLV5lZRCVbWSgrIQsgA3pWa5+tujaa4yvlzS/k1xp4LBS0EW1Ycw5OjLTJViRa+ZV9YJ0uSPgshA3iXAhIf+LB2cl3SNJcUEHUPWy3VohVtxVgUIoW6OxMTfxbmZSeuvNfqVxK+xbEaDgZwkcKmoqUJTiTSeXe++qEaf0KjSC4kFC6kZMeNVINGKP4sQaiKw9AKFXyF8LECMoArWOSKZXhXZDUINvUFnDm61CPzG8ZIGlaBZI+FEsVQeI7hwUnTuIKEHJbGG7gGZABXcyJwMNhS3T4tfcIF1rzC9QKOEZWA8BYoD52YjEcVFVBQW8bV7UJ0NNyPZgAfDmH1S9F7wXKO/IZLSx+6AoRTsRuHURwaJjqPmKxwjOsiQgkm+mRnZdVjaWQAS2m40dyt5g0+R7X/sANoRXFE6x2ewIU5ZUKoISOQTHLBnlFQCu9oLuFqKWtcHDKAJSPy5sjTlR8IH6TWKIIkHJketlyskIZgAEY3xkSM1BnFAjGti+TKCRZ5yf7iCt/SgwG8RwPfeDTyAqAJqvr0khvkWEQOcnLkGC72/7BF6Kr1OXgyS01r5PDKGxT95/keYmaNAbxDAUMDR6EHghTQIqjyclCNu4AC0jACJWXMxAbZYdPB2UC4FOv14djyBoO3BdQKO860DODdNkDflOPz8KxKNgLnnnNRM+gFkBlZgtIwtlxiLABjrPscfLOwXDWjAIIodgeNeSO63JFWTyyFDOAtG4CLcQDG+91ByYO41OzDIWiczBKWB1KIBR6AaEYxrsNhg9ojq4xOmcZWwRh/qf5C/NQxyyEDuNQGIBg/ts7mooc2Qy0Jx2h8Y0fVh3DsUbfaoXQcKaus0zWOqlbOdfkX3dgwxwrIAN5ZB4Zrb/dLxV++DByC83BjgszxXHxtRparGoG4NwS9ce5BqButSkBuRTOAD+vDhFZYOdzdxdTqmTmGJq6GQNL1UAHN+WggyCBQ6OXrH7pQhJ/aEvvcY2EAH5J7Vf7FmdTQqlS9axq3os1vwkNb7OndH/A6ItFDNkMXBVAIT61/KLEEEs+G+28ZPgZwVffxX3Fvg6ayrBXrWjgiVj7Ys/RSB+ReOOt5KICxnsZH/mL9hiJjD8UV7QyhiRgOBnAFBVy84e5a5bC51TRpBJpagMqU0GKIYaIXiYA5nNYK3dBFpUROtQepngnLoH/plwCyNDKAS8xHoYfIx7tvzrVVDEPjRBbSF2NlCAVfjLOBijeoC9WEIJyj9w+2tk5od9Oa4TaXo8ZNGAZwGRPz3SHAx0ao5ptNQA4LOzcfNqWuTDEaU4wOQmaO4Pq+4w1+qulWvLfRctRYARnAu5jQrTpEauCo/p5jhDHaXbUcAjoY6r1wkKD1tmDcMnK2u2UU1IWWy1syGcAHA1jcJAvcrjeAgs8zVYdlvkPYoPkDfdMEMCGeytNXH4dX4YC3wTGAv5mCF48qlhuuvXcsT5wIEbqOicu/xeiLowRR5V5MwvuDoXl2ztUdA7hypr1TAfUuJcSQluD0jBbel428sZ7aV/eFGTa/OOLo8PvGwg1XWQAZwIf7z3zzZN5CWasgeMaR5zji5DoSQ4Oa0Ln5MCxv9+NwuHt2++ZsLIYM4AP9J17MP45Lb6ts5hXd2+/nP7ATKBz4Nj9++egIZzgcOt7R4Nva53eN2/eAYQVkAH+jDswVkICiaayw6E43K4OTb+f7hjE4/PbFGPxYOz///P39xg3J4yzMAD5CK0aXfzhoVfmvfOtyxDK8mWDLE6elK7wWxwD+AYQqARdLJAVfbn7Tg/mPVEobkEq74RhABvD32zElvha71M0bbb5i8PlWHr7xwYccDOC96vfLj0pSF5uLn014+wNCFvMwO2EG8AF1350Lt3ixojf7FtzNV5AX2LyxA4mDAVwp5d7bo5l3p0tjhPkuIx6+ZwD/3PnefbX0uXHzu/0tVUAOBvAx4kZSLr3MG9YPZpqDAfxtfSy9vON+p/M7cXAwgM8QfCcOBvDFYMjBAHIwgAwgBwP4hKmW0y0D+Gz/IbVCwoaDAWQFZAD5P8TxtLFeW2cAOZ4Qq3tO1uwaA8jx2OSVsJpfqd8+yQrI8bhRt+uIVFns6Bjxqy9TQK4BOR5T/zqA2YLQaeGr3YsfA8jxJ7UeHdXsdn09P6ee6dQv6j8GkOMPo2bb3fwogcybkPop2iDn4nGyrPJjADn+TPk6bQKva9ttVfIp0HLVqxUArqR9DCDHfcTV6yWOgDY7UZ7DDiDHYplXAk0drk4eA8hxs6ZrbH740Ot9+roDcTny6ylIXetTbzPPt+12R6XZtg2hDcaDkWMAOYoA5Hq9kT1a3zs9aHXH45nM/Ay+fR/kzsZvmcnacbfeIZ9R09UevO7k4lhbudxjADm04p1ejA521k8PLifj7X5/FKTA3Mg+nnWk3QGLYY9aLWknqZ8FbZlAvsWoldWuRB0rIMfKYgfZFbDr2FLaElSuv53agawFgFjqo9rZiVS0tVp+6re6KIHtdtK227LdXd6J+ev+3gzgk2C3nU5B7HyM/kzKWpoBYK0Wwgb8JTJT4CUBcdgG+LbhnQQgVXvUcPkn/t4M4GNxB9hd+J0ZYJfJFOFKJDIHkdoyBVUDBEeYb0H1tPAF+NTpdrDym57u9Oq2TKZkhR/Q2WMA/2XwQO8wy047MzITUNNNO35q65AtXwKFWZCol34qgbrEpjJPQuAL2Z+lk5Gu+YpZgsdLugzgXxgkeHsXl+Nt8rB9AO8ytVPkDaDKUo1gAESS+tmkifCQ2Iq+oNaZZXIkp9v1A+y7LC6t/Ut/bwbw98Drk6kYTzrgJ1IfLQToHGbYNtR4usJTEJL6BUCi7fuYepMkSYNRf9yq26MPjX/+780ArlbjQardu+jOwZsCdSq9gralrVY2J87WjRSyGIGfUKkHGNYm2yiP0k4BvdPa+pOrHQP4t5B3MCnAu6SGCRkLxKpFixRJ7ioWIvCBylEKFyczibXe9qRfv/yk0Ks9kclgAP8q8vqdWR+qvP6sMwXosiDTnharPCrlfFuvYLRv8Zf4rQ49y2x7cjCBWq+ccJ9F/hjAV0UeaB66WqjpUL9oscyWWYKwFXpH3MniVSKV363DMfx4BvDVL7/2/v+lHgP4yrMtkNeFGi9LCz+xJMfejrQ7BRuckvnd23lR5DGALxq9r5d1f0x1HmVb8hdIUXYXbcQkWd6OlG3QvySDOu8AyLvAbnLjJf6uDOBLCVWEbfYO6uNLQA9oO+7ikqzEEi+ABzyVlHUvkDdMBgBaU0Ui+JNpOl7f+YSa12i84F+bAXwpUbOPd/Za4z4Atz3uttBNtLDOa+fM4bxAgj4W6ryMSjvQxaRkMkbwDYrXOtXgvYpgAF9Cyu19Xb+Y0hLGuKu6KmpOoFzrBZiD2+hl4Uwmk3aQ+cW1DBJ1vw7VXm+z8bp+dwbwmWPvuHU6wawJOXMUZNjVWzQbI5wRaOND5qfUSa4hlZKcSXDc8ced9KD3YbOhNkG+Mv4YwOeMzd4llniZnMo80wZ5DznIuyrwjkCNqQTj7RGNEMw6x1JO1ncOjk9LgvdcnTwG8BV6DXjcS+UxlHAJDquU3YSUKqkmdlvCpWA6k6PATsB+HE8uL/a6Iy13tHDRaPyvvfvXSRgIADjspjB06AxDpyYdGXBkuYUnqL6Jz+BgmHgCFzZ8Q3ttkUI0Mcbyr9+3CGFp7M9rr7Tntf8+BHjyuUbIy/iAT3sHaDqpZ7rN63quscpHYfoS58HpZJauq1nF9i17fI/ZtaeMlesc7gR4zlFv97qaSNSPOO4mr1Vj67rGWR3g7Dn+KLabMnv82GcXq7vFP0gBniC66ngZn+LOsjJ+77+qRsC7cRHWRd5czAurkKR5+lodXidFsX3a5J37328zOwH2rl4ioD3hy7J4s0k9eV2EUegsrVIe34mS7JcaGAYB9hngbrmKRcxsPG3mtYvOmlHNqmbl8foCAyLAPg/BTV+heai2CjHEo3AZH7TorOl4rjvx7O/bCvBwIZXutDdrPxnvbjreH3WP13UUoA36+/WVr5HsIKmDN0nfD5kJcIAB7qca7dvsx4Oq7gTYx9iXHB1zZSbA/x/ifvuxUU6A/Q5xGhPgaQe9ztW67nK0mhTg6Qa9ZJQ3/3kg+b62YV/NE2Dvp30HI6D5rQARoAARIAIUIAJEgAJEgAhQgAgQAQoQASJAASJABChABIj9LUAEiP0tQASI/S1AAdog7G8BCtAGIUB7RYA2CAEiQBuEABGgABEgAhQgNx/g8p7hWF5agMsHhmV5WQHODYADGwLnzkMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGKRP3q93jK/QWKoAAAAASUVORK5CYII="> <pre data-language="python">import itertools

import numpy as np
from scipy import linalg
import matplotlib.pyplot as plt
import matplotlib as mpl

from sklearn import mixture

color_iter = itertools.cycle(['navy', 'c', 'cornflowerblue', 'gold',
                              'darkorange'])


def plot_results(X, Y_, means, covariances, index, title):
    splot = plt.subplot(2, 1, 1 + index)
    for i, (mean, covar, color) in enumerate(zip(
            means, covariances, color_iter)):
        v, w = linalg.eigh(covar)
        v = 2. * np.sqrt(2.) * np.sqrt(v)
        u = w[0] / linalg.norm(w[0])
        # as the DP will not use every component it has access to
        # unless it needs it, we shouldn't plot the redundant
        # components.
        if not np.any(Y_ == i):
            continue
        plt.scatter(X[Y_ == i, 0], X[Y_ == i, 1], .8, color=color)

        # Plot an ellipse to show the Gaussian component
        angle = np.arctan(u[1] / u[0])
        angle = 180. * angle / np.pi  # convert to degrees
        ell = mpl.patches.Ellipse(mean, v[0], v[1], 180. + angle, color=color)
        ell.set_clip_box(splot.bbox)
        ell.set_alpha(0.5)
        splot.add_artist(ell)

    plt.xlim(-9., 5.)
    plt.ylim(-3., 6.)
    plt.xticks(())
    plt.yticks(())
    plt.title(title)


# Number of samples per component
n_samples = 500

# Generate random sample, two components
np.random.seed(0)
C = np.array([[0., -0.1], [1.7, .4]])
X = np.r_[np.dot(np.random.randn(n_samples, 2), C),
          .7 * np.random.randn(n_samples, 2) + np.array([-6, 3])]

# Fit a Gaussian mixture with EM using five components
gmm = mixture.GaussianMixture(n_components=5, covariance_type='full').fit(X)
plot_results(X, gmm.predict(X), gmm.means_, gmm.covariances_, 0,
             'Gaussian Mixture')

# Fit a Dirichlet process Gaussian mixture using five components
dpgmm = mixture.BayesianGaussianMixture(n_components=5,
                                        covariance_type='full').fit(X)
plot_results(X, dpgmm.predict(X), dpgmm.means_, dpgmm.covariances_, 1,
             'Bayesian Gaussian Mixture with a Dirichlet process prior')

plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.326 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-mixture-plot-gmm-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/mixture/plot_gmm.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/ef0baa719e32d13119d996e7e1f4a7dd/plot_gmm.py"><code>Download Python source code: plot_gmm.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/df17584e78fbab6ddca8edf79def6190/plot_gmm.ipynb"><code>Download Jupyter notebook: plot_gmm.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/mixture/plot_gmm.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/mixture/plot_gmm.html</a>
  </p>
</div>
