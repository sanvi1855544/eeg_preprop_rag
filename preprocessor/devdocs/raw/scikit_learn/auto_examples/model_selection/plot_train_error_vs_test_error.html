<h1 id="sphx-glr-auto-examples-model-selection-plot-train-error-vs-test-error-py">Train error vs Test error</h1> <p>Illustration of how the performance of an estimator on unseen data (test data) is not the same as the performance on training data. As the regularization increases the performance on train decreases while the performance on test is optimal within a range of values of the regularization parameter. The example with an Elastic-Net regression model and the performance is measured using the explained variance a.k.a. R^2.</p> <img alt="plot train error vs test error" class="sphx-glr-single-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAMAAAACDyzWAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAADAFBMVEX////Ly8upyuJin8r4+PjW1tYfd7Tx8fEAAAD/fw7q6ur/+fQPDw///v71+fv+/v6fn5/7+/uvr68fHx8+Pj4CAgImJiZ/f3/5+fkFBQUpKSmVlZXn6OgKCgr/9OyPj48vLy///fvc3Nutra3P0NBfX18YGBjh4eHFxcXk5OP/7d7/hRrm5uZoaGjhgCnCwsJtbW2/v78yMjI3NzeEhYV3eHcUFBT/+PPi4uL/8eX/+/cICAj/5M38/f3/9/De3t5PT0/Uxrapqan/iSH/ghREjcAcHBz09PRvb28iIiLH3OzlgCQMDAz/jSrSiEJTU1Px9vqJiYn/rGPt7e3QgTcHBwfr8/jw8PD/0qsrKytGRkZkZGScnJz8fhD/kjPOz83/p1pPlMTzfhf4fhOlpaX/m0L/o1IugLm41OfU1NPPi0v/n0r/lzv/59JdXV3WhTvIlWTegi729vbZ2do4hrxCQkL/yJjufxvqfx//6tfFmW7/xJH4+/3/3sGYmJjHg0PIychZmsfIkFr/1bH/vYQnfLaBgYH/27z/+fVwcHC/2OnYgTH/y57RzMR7r9PVyr3/2Lb/sGotLS1MTEzVw6/GpIEiebXT5PBXV1f/tHN7e3uszePR0tLLr5P/t3j/wYrKqYjGnnix0OSioqLl7/Vfnsm4ubrSvqj/z6X/4cicw928vLy2trb2jC1zdHSSkpKMjIzKuabKjFGNutm6iFfavqPc0cbIs525kWjFqo7Kv7G9g0vwlEHf6/Sjx+CGtda5mnqUvtvOklr/un6qhV5+fn66pIqzs7Pa6PLN4e7EfTrXeyfPuJ/snFRDeJkhcqrbhDVppM3i18vbuZjNmmpfeYPhsILK2eHd19C9rJi4uLiSe16ne07opWnOondKSkrMxbuQhnXdtI7lrHjn39fUq4PL1dm/tab07uju2cZISEidhmlvqM/u6ePozrTw5NlQi7PdyLNhiqJJSUmpmIKroJDb4+ezxdCuqJ2mjnJ+qcZ5mq+iuMWKRQeuVgmCQQdcB/ozAAAgAElEQVR42uzdW0wT+QLH8b8gQ/8olCOglIs3kDtBUNhVrCXSlksggobiLUA3QDGAD1g5MVYi0R6VeLqiG/CyWRNkzQoeMOEZCDEbIfvE6yab83JejvE8nedzmWkLtgXaTul0/q2/T0xTBnES8rUz/39n/iUEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADCWcnTHMUe5/OsGxUNx37H7wRC6N2LrPUAa5t3XC9XteOXAiG1HqBd2l/wGwH5AlTrZ/EbAfkCbK6Icz7bGRsb26ppjQXYSmu+OsgBdmZOrz3dpwDwJT+4AZ6p/Lj+XHgF/FaRj//msKV8RWtQA+ys3OP+rVhFLE5RYEtB6KMmO1txIDuXlF/j+1OlZ2RktCJACF2ApfYj+RFyJJmQZOdzBAghC1DmHQACRICAAAEBIkBAgIAAESAgQECACBAQICBAAAQICBAAAQICBECAgAABECAgQECACBAQICBABAgIEBCgCK7rA5LSspa6IQQIIQzQdX1ATWZtzBVVFgKEkB4h1wMsT+Mfio8hQJAnwOSj/EOWKtX3DkaiwOGlu4kvetaMCOp5K7zx8eXl5fnJSYOhKcGiRoBuAe49zj/kKYocX+20r360+Q5+5iAYxqwmk1mnMxqHo1c/2xaXpqJ66sfnDeqvO8AMx1eO9QE338Fc9Nfr580Nb2Rcp3My80w865j3ME1mY7RtLmpknPEWJT0Ee3sFhG1TWxKaDIbJ5fGVlfqRnomoqaU5m+1ztFFntrqmaNWtLkatGJQYhIAElOsPriyG+ZWehTlbtNG89kppMi72TEZkgK7rA2oyH2IahrHXycmRKduw2VGheXVqxRJpAbquD0hKy1RJmIhmkGX5pU1nfzW0Rk8kRNohWM4dgP8S6peiTWw1iAC/upPG8TkdQw0iwK+3QdNSEwIE2RrkxyWmuSYECHINjyd0QoIGBAhyJdjDJ2hdNCBAkC1BI5/gghIBglwJjvAJrhoQIMiW4NQYZ65HgCCbcf5UcNGCAEEuCTaOM84jQJBNj4mzRikRIMhlcpjjbGoECLKNRZbG5CgQAcKaCb5AJQIE2bzkQl8gAoQvojhuUYkAQTYLIS8wgD5ar5SfJ+35CDBCC5xjPMAfK+pUGvLiGgKMSFMhLlB8HzdmSIOG5CUhwIgtcInpAHcfFgLMbUGAEWqJ43pYDrCiXQjwjd5lU3pSS1mJ83nnk8qcI+cRYBizcSYDwwFerkpt0OSW1X7ZckZ1JaY2M9f+vCRlVlNysQoBhjGLjhtWsxtgbPLuFL0quebLlmPF/ENauf35+zr+YVaPAMPZspWbYjdAQqbfN0+7fJmaIizFcTTZ/kWe6p0yI7kYAYa1BW5snOEAPRQp8vjH43udx+MGlaIKq2OFN2U0p0tgNcCjs8LjbO3mAcbkNP/4+5PLju94Wx8QWGYwczZWA8zZITy26zc/BF87K4xEnEukyvUKeLvtw0lEtC31oZqLER9gy2Hh8XDL5oOQs8+Iyxq98pwDFv1G6W//RETbssiZJtkM8KLjEJz2ZYswDfMw07FAYKIqXZNXdkzWQcgj+t2fqfbVIVS0DRZjaOZixPdxpfLX0tJfM10XAUxPUgkT0fYFAmfTKnOu5csZoLKP/q/hv5R23URG2zBvDclbcgH0ka5XKOpeh3CYLdJ9+l2mQjFYSLWD8egocFEhmYsJqI+4Gol3sB3xXfQ//Ng77kQ3pb0F6CjwI8kqZ1SyGSBTO9gwBKbaBiFAEv+okBY+RkgBm7SGYCQsvo+MazkpAlYD7KWjCnuAhBR0UXoPY5GAzXE6NXsBfkpL3yNgNMC3VPuPtQDJyeeUdu9HSQFqMnEL7AXYkM30IbibjsatB0jIBS1tPIWUAjTFmROYCzCtneUA+yktcA2Q9LdR7SOkFBiLTvLr88X38eaShuEAO+g54hYgOd1B6SjemQvMBGc1sBbgblVKw24ekwHepPSmR4Ak/hWlbT8NPr75AEGJpTRKfVGC+D4SnZgM8BztIJ4BEnK/mto1do32IypR6rmxZcYCZG0Hrgoo7d8kQHLi0YeOvkKhwWpMTYsTzUWz18dALI/FAEdpN9ksQMeheP+pC320DwdiUZbHuBW2Aqw5WsHqRPQJLX27dYD2v1FNz+ENYlFs0r4hJ76P4rQzlYnH9Z2sBXio/5du2ku8B0huUzqIqMQMQwzSviEnvg99KWk4TF7/e5s7OPnAaZenb1yd3sx+DyduD472aYVTvNu+AiSDzr8E/prjdBaWAszMJfo7RJO5zR1002Ar7H1+l/gMMP4crT6BqkRIkPQNOfEBPikll2bcbv2VP8DGjnt3C9bP7bwGSB5gICLSAme2MBTggVlSWqlKObDNHWw89O564OGkp0Ou4h02+ae9B0gKqukoBiIiWMzcBFvTMCQ3K1vaHWyLjwDJfQxExJ4FGhkLkKUdiA+Q3KLat8jKf4YxbpyhPu40zzzkhXGAwkAE78mJ8Jn7zE6AxxVpybwbYRwg2dVHC++jK7+tSHdRTADrAyZu2OS6PuDOF0mquiuMB0hO91L6C8Lyl9Io2S2aASzNcd1zi+v6gKTq2LTmTh7rAZKT5yh9hbGwv15yZjUrATbXem5xXZrj3e7zYXAIFs4DP1A6ihuW/GQxSfV+nPg+1J/qnlbx1je4LU5UfKM8Z+/MgPNwLM/iRH4FKKzgQbu/QVv+meOGWQmwuOXTEcH6Brfl2S61/P3OuyTnN2Vans3PAMljLe3DLXP+mZRqJiaAu+I+emxwD7CylZAsxUAYvAIScqqaNuICVf+sSnRtvvgAk2I8NrivDyisER2juM78OaBdQRvt24W4/FHPWZvYCDDxWY2XQchQJf/dPSkD4REgLlD1m1InzcLl4vs42NBwsYznPg2ztj5gjf5sTMneyyRMAiRvtfQW6vJHlDQzMeL72Ofkssl1fcCYG5X6mYGwCRAXqPorQZqZGNF9/GnftxIXHtoAcYGqvxYlmYkJYBSsiagAhQtUu7Bwgh8ngZNj3DILAVYlRlaA9gtU0ZcfoqWYiRHfx1DOTCfDy7OJD1C4QBXLF/lBkpkY8X0oHFIiJ0DyimqxhJsfB2GdBHcnfZVXRG8YiHTQRrwn59uUBJfmI0DB6Tbai/lon6S4ND+APkqf1tU9LYmoAMnNQsxH+0GCN4TF9/Fa9Wz2wDNVZ0QFSB5RLe4S8WmEM1lkDzDNfkfw+7TICpA/DWzD7eq+qIN/h7D4PlQbPqwwEgIk+6vpcxTmS/CvSxXfR539U+KG6iIsQGE2EDfK+TLPcZNyB5iuKn79urhlKNICJD/RaszF+DIc7GXzA+gjK7miInkPibgAH7TRbszF+DAR7IuyRPYxO0BylVIXLlOApF+Lt+R8sZi4ETkDTIkT/gS0A/VAqBQl8YoC+MFBrRafMeyDjVuVM0B9eq6iPddO5A5Sr8eEytV3vKuB/OT3f/ThyizvxoO8SofIAIdUKQ5iL0ZQ5h6uCdUrYOwOXmwgPxn3/R8f0Jh3xuDeGyL2FC32qmI6207cDlJjWkP2K0oVAkwN6Ef/9YMWn+/q3QKnU8oYIFEnFgWyg4GYgXAIcOCvf6NduFXYmyZrUD84RPwgtUUTyQHG3C2khReQmRefg3pFgvgAy6YjOsAB4WPWR7FmzNbqOVOCnAG+OfixyOOjulzXByQkL+WgJAEm14YkQHLoHqVtuEJ665MwM/dSzgCFy/HdR8Fu6wOS1rpL2w3QedW/4ojb1vOxoQmQkNuNVHvr/+yd208bSRaHKzNx4wY7kBgMBkyGe7CDMJgx4AtGYMwQYRFAXAYixxlxGWTgIc6wQgTEChKYEYowIyWYHYG07I5gEoVI+5yMIrRi31Z5zUse9mU0r/kHttrtSxtfcHeXG2PXT8K0O9RxRf50Tp3qqlP4oUg0vUe5IoE9gPU+Be8wS3MAsLObzxfA4uLimxL4QiXOHEDiDSAocZDkBHaCUfSP58TbCwQw/PtmFicCOQ3XAwAyqmOxDcE5EgDM4vbcwZyBHavh23FfCJY1VvZYlxMOIJBuquFIEG9Yj6x/Er9fJIB1c9oacBAc84WUZ3PpXCAAIKM+IPXNZl+LqexwAGXl5ts1byrMx3krPgB1RWV9eaKEAwhASz9Jqvfxc5FI+h7hwmj2AJYbxgbNoOhzRABNDdA9RfOA14iYuhYOYOA4pk+vfQDOAZCtWxYAQACMMB22reKhYGLTEA7VsQ6o6hwVVRFD8LA3QRHnvYw0BmQPIEW2qXFbp1T0+gDsg3e2nwoCIJCO2EjSibeKREpDkJ0hzB5Ag5kC0DwYMQkxTUPVyqe7IgHIPgRTz/v6dAcVZZ/afABSPvGrfGEABCBrzUKSDozgWQ2hexrCYUn+SwrAg8LQaRh/fUDv0I9vFhwC4M9jkGv5xQAIgAoOBTGCYUJ3dBKHYxoKV3rqxnXHjFvM+oDIAfzReks0JrkoAAFYwAiGC93RSRyy4F2DWGzYZfkB3AEcaOvR7c5dHIB+BI04HWEI2dFJbAHsqq3S7aysdIEEA8hHqAH0Iah2ejaNeO8wLWRHJ7EF8LVyTKPrZf8BlxtACkELfTi7vX9+AftCdEcnsQWwexyAFYUp7QAEQD97uOfs8ELY0b+pSncIUW1RZwugooaaiWlOQwC9kras7096faHNPZLWJ4ygKtjLFkDvnjg2ZaJTC0DaFy6tOSkI1f3rabx8H1GlLLYAij+1tbUpRpmHFaYdgJSa1k9sVDD2HKVrLEZUsJctgJUBpTeAVDg+8lBDQtvJ5uq6UVWSbusWEB2dJFSF1BQEEKp0vV9N+mWxTTg8+4frC63p4RTfEZ0mDODFAgi1MeJ2OGdsQQ5pFCfda/MjW0tHxgVVS0mTPjKS0tJSvX5jo6mptbW1JFzwbmvThr60NDmBvoakSgcGkCeAAWfYqjKuzp+4nfYQFoNQqjtsUB1QarXaYrGQrAQbwGZq2Npms9tnJiackw5Hv9tzsrY/vzmyuk6T3qoXktVnxJcYwKQBkOkUVcatzX2PwzkxY7d1qFmixlMU6BBQmk+3Z+9kbXFzdcmoSsC44C2BYGl+UgIYeVMS/SD4EgAY5hw3WktaVKqFWaNxdnZhYUEF1QJFR9mmrA29HsbZUmkIIlJvfNZvNHmjM/xrqpVqARo5Olpa31odOdycX9xfO/G4++MkvWPGsbe4amxBRyKKpflJCSBzU1IKACiYpJB0lQoiCgE93KQB3fPAMardxoDT0mGfcDrce/vzh5RrLNngTORPxNTdlAQQ0KthwGnDYHf+dQDyrYoqDcilnCIGkKP0LbNb8yf9E7YIUds+6VlcnW1lbdPUyX9NjJAASrNiSnoWwI+SHPOvsnzQLnlVvbIMBqxPi4sxgLwHBC0LR1sj8/sn7v7JCTszfe+YcM8vsapS/Df+RRKEBDAr9hgl6yyAuY3w4qAKvJEX4BCcuLjdqlrahK6xw4+hcy/up9ymR7wno5MZQKVBqVQaxF3NVutY+XUMYILVNDuy5qAjdNxPub8gHj2+PACyDcGGvjJKJvDwhqZKW4ABFEJZxsM9O/WEcW82juTk8SO+B2gmcxKiHQu+d4nvA/kbDKAwUZl+yj2zeP6A8B1fF5jMAH5U5E+L2ndBzr1p865hAIy21WRiAAVKmrccFhiKPecV64Qu8IvUnYb5qDVItMvghlai1L4EYGV7EE/DCKfWzRnoBvvP2Q/4G8/NIUgAZNQHLP9B16P9yB9APsIAogrF65MQwcmlWIPBa1P8ynSgAJBZH/CbviuurxX3MYApIiO1H3Ai1iF67/mtykIBYGh9QOr6KQYwZaTywMFgjKMD7k7xOsIVeX1AKJPVVzaBR31ADGDyqMQD43D0hPhfvFwgAgBD6gNS6tP5ktUz9QExgJdVIxbSZozhAr9PKgDHlf7ibNgDpopm7aRlM1ou8jufYm3oQ3C74RTBNAwGMMnmZBwk6Y5Sl2ToCY+1+ciTkHHDDYABTMEpmUWSnFGhd4GopmH89QHHFUWhK0kxgKmipQ5SbUTuAhFNRAfqA+aeXUuPFsCQ0oMYQGHVMhGNwGdE5+OLBDCOD2D5zTaPVSlkmgHmLTEV2rsG+AIYcUlN4BAmDGAsZTmjEAgT4d9SCkCzLre++tW38oGzAPIPwRjARBD4BeeKqckJ4J9W6q+LlTC7kT3dUVYdw98wssu8IbiyrVEnyb/+WmK9B0C9GI43K8RmkCM5lRt6u3JkEs1DH4BF3Qr5AYXuvTZDtw9f38aSW7kGq6aL+pNBXS+opG6aMYDcCTQ94Fo0WlgAM2OI0WZA3Oj9PSbJBrKePtdx3q8gU5xTnEkD2KNx3ROPNroaFc0MABWj9+t0ozuiU8U4DWC5osj1Jq8eAmgdL9P00N6U3ljyS89N162GSnAlb7z6/jEY1o4VF5swgDwIfEEQdy4BgOIYYrRZ8YXbm+JMIPsTXux89oVgL4AyyIocJjwm5TgDQHEZALVK6NVGx2gAvetZez/Blrtw8Ch+xQjBc9Q/1eU9LJdk4BDMTk1RCOSahyQ1gG8oAKmFDTdlTAA/UchQc4+yYwaASnjj39ThEXNtNICSHKplN2zZDi8kBwwACxVKKLEoY1s3N96FAURAINc8JCkBDAnBT/0YBQBs8/ssCFOdGIbWK94xoH+WpvJnH4AHzJZeHAMAary7TQrA9Zevu7uHMYBsCTyKlIdMDaUKgGCUkYR89oVgRXkkAEViEQDLEQEMhmAmgN6NJTs/BD+rCxoe1WAA2RG4hCoPScokBLh0uXXN9DSMTNLnKsr7CMmpLR4IB7DA2us6lUcE8IZi2ZeEMAH0biz5xVBb4bqhAafHFdVFedNgTGvOxEkIGwItq4jykCSdiK6urFJYvRPR3mkYKmyeditk4QCCW9uG3PaIAAanYZgA0htLroz2KLcbQV2uxLANR4gurQFPw7CQ3kGSh2jykKQvzxbvZmCG8KO4hKvUTZLzZ28OcclDMIAYQC6S7pHkmhRBHoIBxAByI3CfJPekYXnIB1OqAchBGEBBNE+S7jN7lV48Z12yEgOIAeSqQ5KcPLNE9e8E22EgBhADyFlbFtKyH7pO/z3BcocSBhADyF2zTpK0rTJHgtnPiCd3khHAAtHwZQBwQGTCWLFJRUZsJOlcYCYiXxJT/0lCALOry7oeCqQMCsAMLi0HRLcxVOyUtWaB6TCjvvTjB8SjoeQDEFx1iYTS9CuoaU5Nb2djpNhK5SDJDsaTuaFOovNu8gEITEI5wIe3ZVC3ubTE8ZeT1u0k2R+s3fF2ivjrY0EBZJRnA/UNg93LQhIerkxqcU0m5kI46ddCnOCLJ8SHIQEBZJZnMyu/Ed3zrpzCAKaTjDNMJ/jTc+L5hzvZQgHIrIzwNbUmuVaLAUxLJ7gVIPABQRCd7+4KAmBIbZhcDXwpVxRgANPPCcKRoDuQDr949oQgnjx7MeRX4gAMqY4lpxbT3xLTsxlUdaxmcU2GwDJ7d1lmYAmsP/733Xd/WfvD/7b4/aP/BvUkSqMa8XAiAKSP1MoXY2Gdp5rEhWDKAw6bhynQ5Rn+Vzl9URPVM8qjvZWH/Ga8+szGazKaxaAxthZRdDJOi9w7Kc84t5OovhsWnRyu4T/3FTMJ8akw8FpIX0SP/YXR3haG2QpY8/7EazKaxaAxthZRdDJOi9w7WQjO7SSq74ZNJxGIWZ7NrPwxdBrGP1UYeC2iL6L3qCja26IwWwFr3p94TUazGDTG1iKKTsZpkXsni8C5nUT13bDpJAoxyrOB+gaFbPliHsGgN5mmnbwU/22+upp/NflNpmknL8V/Gwvr/+zdT2wjVx0H8OcSJ/Oys2uv/8VOxtjYXseREpI4iYlkWXYj1V6jqKllslH+LFGXIAhIEbJrAavFWD1ECggqZVnVhBS1eLVITeQNRbQsB/4cqlCEckCqhFqkvXBhBVx64AAH3vPM+M/YyebPczzO/r4HxzN2np8zH83zODPvB4FAIBAIBAKBtG3MTuci4yZjxiLbBrv8zvks0xYnTb10XhqWifAzLJvbt8SXVN1BVgmwb3JrhjHAUAzF4kmWLQ56UHc0xrSTo/sst+9Vy0AX27fMuIMqBpie0ReZN5o0Mj/Ha3OSbXujLLevL4LQyIqKO3jSDN/1inPvVp/CT2Pzm0bZthhJnxbgoU3ObQb72LaIkGaecYtn2r7KZqdGEErssd3iLQW4u+Uudad8Cr9/nmYQDaJVYxfLFg1FdFqAh3YSIWFMYNtistfHuI9n2r7KZs8OsK6jrQWIpLki6yqskzzRsGxxImoM8OvMOzk0xbTFDlOB9R/yrNu3plkmQ7Cio2oAWFdhPdmBBoxJli2SnOEzYMMmhS7U1bvNskVdvofxH5INwHKzV+MMDkIUHVUDwLoK6775TaeBaYtnB1jXpMa5udnHtMVhzul0bjN92wuBYFTDbvsYLPEs2y1+5g42BaDKWmyLTjbhbbdVRxmPHKpqsS062YS33VYdZf75XkUttkUnm/C226qjp0rM4+Ecnv7yKfxqbLEtOtmEt91WHT1tRuVq6tIp/GpssS062YS33VYdhUAgEAgEAoFAIBAIBAKBQCAQCAQCgVz49DiVa0YPnXD2FHWPIc90rnGcOTqUPBlAq1Bfm0DP09vuWJPtQy4awCfCwINo/kQKGlZIFAGeMNYTA7TCJrtgACPkpkgvWdb3zlro2fg+56zfwHlEUQZOVKDJBHjTMlnBZSP29+kQbCqdAhJGe/P26FBMPCOkpzQE90fs0zMC/b2Ckc93yT4NltnMJEKuSMDu36Gj9fg1fg1NWILxLSt98lLUPhRKeAN0/ve5xcB0hnSBNqqXl+hz4hyUubt4AMO9XoSyXnfYHdCjrsCadteiBLhT0GoXvQQTF1gK91OASUEQZiwp5BgN71iGkNXBC0KMAtT5TZqc30R+b3pmddi7JQG0+X2asTGEPNnt9FawnwDk91wuNO4L73sTpSdr920LI2k9l0M6011NuhhIporzgpCSl1CPfWF5GwBeMIBme5DjyH4rSq9MHB9D2UAKoSUlQJrQ9D4BuFE5CHHwafGRqYA8BBOAD8xkP6flNMQLAVuUZnKnrsjanLjU+5A8NSL3IeFH4pMXjCGELAm0w9OJRuNZ8aUrSzaoy3PxAGZc2yMLV1E3F7Tb7bMBtJEha7eVALuHLLydIyM0t1IGuGt7QO9nvNNBLlYB+NBI7/AF1EOnjnfE5T0grVPA61Gs2MvbzUU6BJfsmrz0VcUnrz0mN6YNlDCTvtjNEyLAylIcttfF/Axo2kICt+IiCaPrFKCHACxQUVMSwE/8u6uugEO6+KEEUMvTr1z6gxu59BJZLgMUyVGAVI/DWAOwgIbi7m2X87r0jU3OPK5Jr/PSblbszHWUiNK+uLolgDVLkAsIcDQ4iKLSFAvZQIc4BO+S3RrakgBOFxCa5KoBJuPX6NPdFNY4WV6ZrhuCawDS0TdNbubJ68R4GeAe1bqoBPjAHBZ/a5zOKlNeAoAXFSDyj6CloCO9rd8rHYR81EsAJu0jrhWvBNC5oM2ZgtUATfP95DAk5OEc4UKULPu4nW75IGRZPAip3QOO5ZbpQUjE6fHcnZYBGmwrrocBJUCdyflR2LelQSt2T3dHeQkAXliAK7ZJtOK08SY3Qr5Nm3+FI4cXhnjwblYCuOyftUwZqwFy0tcwDm9woUCH5KFA3dcw1QB5d9yWIQe/4Uww2meSAaJiYDrvUAJEXSNeW3RtEnXM8Jy+vAQAn5ms2FKMWzzV99SQZzGF4bAhuoYAIKQ1SRhnjRsxAAiBQI6d0MAc1BKHHBoW9YKPzACUBIc0t2L60Zk7tPo2BEJLqc81F6D6CsVC1JSm+wCAEAAIAYAQCAB8BqOzplQZq671AL/z488BkCbH2q9VafqtLQeI8U9BSHMTSrvm1LkHnHOlQ60H+HUg0tyktDG1di2mTbUe4JfrV/7w5TvghiHAlMq71lqAX6xf2dn5PXADAM8J4DcbAfwquGlDgNqxWWf7AbwFANUEUD494NopXimf6U+2H8CbAFBNAAVBoNM4CPT0gJNONeN/vx2HYAwAVTYE0/Ozw9yUaVZfuXJKnhuHJpSI26LjCG1ngoHFWOVBcQIcFQAc908HIukzAYSDEMYAdVeOjK4eoNEdHiwDlOfGKWWC17uGl1DMO7O6Q69/lh8U5otCTA0AF/SrnsfGGABUEcArnUfmSj1Ael1oGaA8N05pa84ulX5mebKJd81C5UFnz2m61pwhuJsbPhbAmxh/RrlOBwBVANBXBbA8Nw5NjhPnYtigtX/nuOHKg2oC6OJWxTsdpTNeD32BWxh/WrkuBABVMAR7yL31TUQvBKzMjUOzLQPMiAArD6oIoO6uXBq7p3RQfxTAbyvX3Zn4uA6gDma+O+eDEAqwL0D+7Hk6BK9XtRdUDsHygyoCOGSULzN5yh7wSxj/ow4gxr9R7hRf/hRIOn+AWi7h6uMJQHluHHGfwhdcOfEgZJQehJQfVA/AkWj4mF/DkM+A/1auu4LxzxWrXv/wACSdP0CUjdrXxunXMPLcOKW9wbjRZqz+GkZ+UC0AdSPeNDoewBA5Cv7VMQCmMYYx+LwAnnvXWAMc4kcFQUgdB6CVAPyzcuVL9QDfxTgElADg8SL+M1F/HIAxAvC9pwO8TABCCQIAeNoc/gJJAvAN5cobDfeAKaAEABkDfPuf/zk+wBhQAoCMAf734H+NAN5vCHAOKAFAxgBfxL9vAPByY4BJoAQAmQO8TQC+qVwtYPwLxaq/YAxlWAAga4Bfw78+JkCyB/wXUAKAjAG+g19tBHCwIcABoAQAGQN8Fb/TCGB/Q4B/B0qtA3iiSayf/uRstHS6oQoAfpcAvKdcHQaALQR4rfRvhIXycqliSar7BNqeCrDL9nAwpgaA38AvHgrwuV9W/e9NBzBnsq4AABlrSURBVADPD+ATgSRZC/BEu7unAlyVzihsOcDb+As1AO9/vvTDRQF2dv6k6pmvYfxXoHQ+ACPSnZ6ozTsilt4umaqtml1bitta9NrHRim+aDCyJwMcyPN2fw6hvrjNUkC1lbbD6gD4fQLwLXEnh+i1IB/Qu2n6/+HOzhcAIDuAly8dmcv1AKf43f5cFiWj64IgAqyumq0oxZ0fG3btzaZRjkukH/ISwFjcNOya8iG3rS+9Zx6tVNre4TRCSA0A38KflQH+7pUbCB18+Da9ryUAQwcHnTdqAL4LlM4A8BI+MpeqAJYKEK+jPYu1MgSXAFZXzRaNyqW4Xdwguc1MoPwT8jMvAcxOiwP52CK5mXlcqa3tUckQrLuHvyUDfIFeBoLxfukjAgF4B+OD+5WnPg8Azw1ghl7hkUST0eii+2o1wOqq2bWluKc4itaWR056dr5DAjgkXZbB61GpNne5trZaAKJ7+FYF4M8owHsywCsYF/8IAFs4BKOUYcQ7Zq0C6ESVkp21pbinzGmqVqgFWJQBFiSAcm1t1ewBH+GbBOBtev+VzudkgJeXCcCXMP64FuBrQOl8D0Lop3FuGVn2GgGsLcWdli/CzX9SNQTr+dohuFxbWzV7wEel3b8E8LcU4Jv0/g8wfqML47+9XnnmjwDg+X4N0430S6vhrWASLUQGuusBKkpxrxndYU1it/YgxGox+cJuHzLYstJBiFRbWzV7wPcqAL/S+Qd6gYgM8FES4z99UAPweaB0PgBLX0RbkGGMt/+fvbOPiSq7AvhbEyeeNSNJt212+0HDStYW6NtuV2OgQDsFus1MoATfWv7YAXcmbBvEwKSNM4JktspG4jgFukMauvjBxhRoO21wmQWdsVqdWh0ErehQCzQCdbShH9a4bXfTP3rOfR8zAuLoPsR0703mzXv33XvP/fi9c99977x7X/y5ILz+o5dXzQdwzlLcT//2qWee+1qnILzyja+8qT2GWfetux/DqGtrPzYa8C4A36HPMTUAPwNgMcdDdnMAHxWAy5C1ZdOAfXEA3zCcoG9BGIDXEMAvAFjZ1+lnzxplAH0cJQ6gzhrwGAOwjnbHxQ+EbycAuA5PPIH7O78jhYwcQA7gEgOIt3+DwpMJAD6LJ2h6nNIRgHwGYDdHiQOoM4DXNADx9q9fwG73qMJl+x/wBA3tNyOANwXhPAeQA6j/PaBXA3ANAfjVOQDiEEw4fIXZQp+fb6HFHQfwXu75N59b9bEkNGAlA3CXwL5F7ycjhHYVwHfxxB9x//gGFcDzHCUOYJLuFz9ZmxSAnRqAmwGC9AqOvQkhAEk53qBB8DizBOQAPrzLW/nYflC4aeWSLdWVFIDf0wA8TAB6FQ3Yh/8tCoA/nmAADiwwgwd3SbqslZsez7XiNq3MEpYTwJR/aQAeB3ATgF0KgF0mPHEV988FAS4Jwv4Fvl/nLkmXkvW4rpaZlbL0AC42QWUcQNyL0KB4HoBmiQOoQy/8eGrAvPv0kLoAuNgUvccZgBN/XUNW+JGUY/JbkezrCCA9IjyDB3stzBCLA/j/7JZNAx62A1hB+uUJMoKWdioAEpRdfQqA37WrAB7lDcUB1PkecLMNwI4I3qHxsLi5jwFoZO+HCcCTePA2MEOs/Qt8PswdB/Ae7qX09FWfS193XwGbXcBsoo/Q+MN1eIA9lE5lAA7IAAo0f5uJWQ5yADmAyboX5qy3eC8BpXiD52QA4vjDfvYqA3CbBiCpQwLQxwBs5w3FAdRZwE4RwI+EVTOzhHNX2Yj47wxA7HNhEIP8VAbwEAeQA6i/gLwhsMYBjJ1hAI5qAKI6FH4HzAyBAMz7/Tu8rTiAegpI8agakMYcr8sAXmcGCkeVB4Rr5Wn0EcAus8HA24oDqCuAEkAICSthxvkvtNPdoHCZAXhIAfA/MoB4qmsvB5ADqLOAiAog9bg3TjIAjzAA29nYRAZwgAPIAVwaDRhUAaQe9+pJ6oyFEg1APBDekyeRZgCOb+BtxQHUVcAVGcBauseDM/WMOQ8DsItxmQhg/TW+XBcHUGcBF+RBSC0BBl2DjDkXM1DoAhsD8A6wl3DIY303X66LA6izAMO48zoDkBRevQygkwFYDy70FoST8hy+CoA7eWNxAHUF0PD980jYRYGWa9g1SChqAIroLQiD8gyWCGAdAriGNxYHUF8Ai7oZgJeZUUICgHXgAcc8AEt5Y3EAlwBAh1AHFmYb6BEEmwJgLYg4Th6U529TAOTrxXEAdQbwVRnAU2y26DiAR2j+cheG6JcBxC56VzdfL44DqD+APiRMLA1CkAHoUAGkJUScGCIoW8UQgH18vTgOoO4A/oABWBSEfhVAuwLgLrCVEoDWBAD5enEcQF0F/NBwjgC0jAC8zwAUFQCrj0Ad2N/YKbjBpgKI4+Us3lgcQD0FpKyhyXfBMgRwhwFoEQSrAiAyZzguSOAis6w6VIoDfL04DqD+Av5J2OHvPRnAojUygNW0lPCFwwigIwHAdbyxOIA6C6ApEOjt2xkGoMuwAhQA0ePCWcEDF8ksCwGs3g/wLG8sDuBSAGgH+38jBJ7T8GsGYEkJnLHCyFlBhBIOIAdwCQXQNFg47rjwlmGEAbhCBfBohObJt0C1CuBRvlwXB1B3AcZ35aV6DG8ZDCKAzfC2DGAtDFwB+5jghFNkmIoAliQA2JixJPlsqNhi5Dh8BDUggfczg+GDvwAM/VsD0GCHzjwbXCYAd6HXIW21pF4oTEgho1mnbG5EwRkch4+YBrwkj34NvzEYTvyNbK/Yce1F6DPY4AkcE/+JrFQJwHYNwIMAG7UUeqHtw+TNmL1N3c1Fwa0PmczuzGRjNvY8kkZNW/2gMZrbWnXPhbHjgHE5APz0Uy9/+fnkBMgADr1aajCsuEnWpzKADugzu+DzTwJcVwCsRQC9cpwOgF4tga0AdyWY2hHXYruLe+9qFAXbpuLseBVVgEpgOQpuSEt7qIoGKE4uZE5i3oXt2+cFaN3xYWu/vA37hC2Zc5X5xvz73IAAJMCyukmPzgCv6exlAPDrz7yy8pufXfcAAF4UhL0n8m5qj2MQwGOCC65dAud+slIlALu05bqqAPap8bOrEtUhutegQmYileY5ymykSm2tYpAdKOxVGDgd78ABOpTdJhRcVlGRSGB2fnIl3oOSsk+ntlbkLtQK2+MN24PZbUoUjs3cXLO14bUGVUFqGDzI7ejGRiV0a1vvdryM6Io4MEclVhRr9dQq18OBnp6Ei6EM5EtxR7N8kRcLGW1YHOMOOeltbRlyrnLbUpO4znKzFahRraYdaHi0AL74Rdx8asMDAFjC9l/SAJRE8OEI+FgApLkAGhtaM+PQNFLo3G37sHLSylnF4HEO/e+DGpbUwfyefQVsQdLVAFsFYw7RAm0qWT0ABRi+uaMspwyqKEJCm+zIrJmX4Ywq1Fo5cxQgRawBVMZV88KfLgbQel2WXahRlEt5DbuSdjPPPamqdpfP7ijoiMvJJgjyt99TKW2BcpkyeUi3hdDeotJG/BsbMHMUJs1IeqkwX76TSVR6mJmD1GvIEbGOU2uoOA3Q1Lwnh6bsqSjLEBoKGzOhbJ78Ntan5JY398oKL6cCL0h2XUKTkQqY8ygBfPoTa3H7pY8nJeDPVAuF1fJdiAYgm5LIATei0H+erFSPoJKsB7i2b9rEZk6wFkRHxypN6S2FdBQC8Mcqp8FvavHSxOfTgUCLuUBNKJNth03eAJ3yF0ZDzGPGO5ZuHkufpF2z148hAKJ0IhqLdZpi6SZ06OUzjXm7cXfM5/MOz8SioxgyFCocNo2ZY+Yxr9ncGfUHpiFTEec3p5vNLd4xis22AeYb9c0Mh0KByUI5VEG3bzjk9cnl7PQrGR32mStNeDAZmgmFKF8t0cJQrNI7PDkJoTFzSwgKvF6UGAtEZ4ax+Jj8jD9gCnh9lMJwwGRqmVaKPE2FnvRhfXhjWIZO0yQTYE4f9fsDZizWqNk7wyoGY42ZydEDWX9Li6mAKmmyUslTlObx9kOIqgJ30mXfblMgGsOc+AKjUZ/JVIklmcSistIFqNQzVMhRVp1+fwj9K80zo7FzjwjArFW0xMz6T7KDxeYH1ACEU9r1e1LlpkW4CDeG4f1EAPcr5yJks2WzLrT0suppWdg7wdlt9g0uO8AEWEecstcIxRqiA6sd7uMmNoDNhlsre445PqEkOg5D0iKxIhORCXGBtMfZs4CRe0t1RZSdoYgVHtLZxymq9QpuI1fiqYjj4oQ0hOLFuXU5tGgNRtTw1gVypGRXTWGCChhJXQYAF5shFV3KP1j+Lqu38nEAvUItXA3Br7rJSpUArAOok9kKF912s1a2Oh1hhwNg6jY74bTQS71+h9XjoZaUwpZZaUqavYV1vN6DzS7OOjyzYYs4NSWFJZvaKrfofbPrVlh0uYtuB92qfJsoWhSKHWICM+Ks2y0FXUSfEhB/mCMyp/UwGOVgFMeFW2mWkhQdksdlk9YXkbvlsYuSi5KaYuLC/eGiIEnGGA6Pki22DVLTimFPP+XEPqVcJ46g5CapTtFDGyqqLNFiwcoAd5hVhtuNxy45HVGa8ogUyBKk9D2UrLSeCXeq5bBO3ZasLodjln2XCGGPDT1sYAs7PbNYn/3rbUrd/K+9uw+K4rzjAL5mdL2fupwjolD1mkPFHOBpfaOgQAjUl5wwqBRIVMyAMCL4ghQPFWobbCS+jNaX+o7RcRp8GaexSiY6Giua2tpaJuqUNBlrnDjWP5KYf9JO8k+f59m9Y1EUOO+5I/j9zejtMcqP3d/ndp/fs8vu51kbncaWycpaW+Z0ix/X7XSeu3zu4Wn+EznznQ8vZ2U5T//soZvK1nqgOu1BOAS3twfUAd7W3/BbYnkK3aBk0AcF9L0AuJhtdT4ZTaeOppVqnk5ka4IYGs3OFb0wH89o4vHz7Kvx7Dhk6kt4z2Jb32r9q408RaL7bfSO+YvEIMoYt7F/NKVuk+iQ02tXxaV752k0tliaO6WRDSu19elr2H9emVaj/xh1RUuKiI+6bUuMhCtLHmkFNfbvbXnpfEjHWgZPJ1zIOxmlb0ldI+8d42oorS8bgeVV8/GavZBYd1Rduil63RoxEkyqSeIDQ/tRu9KYtl5Zx/7oo7G0VYp2sNA77uQDPTEXoGm2vNRcTTnKx5vs52QtiRgERm8lMXxIr/U0PvGNS2pSjTattkbfa8XnslGcVkJ76tP1LRC9aUopX2O9AytalWuM8uyNs5P0FTRGr9H6wJZHfVdsQnSA9x4H2MzU7ST6bge/StUA6KLV3saU9aymGejokrqYNQLKQf0LddTSeSVtbaOj1PLY2LOGlz8hlbxTMew7xaTWVEenpYqWUVvn2WjV8TpOT/Oyh9LYptXW13v7ZE3/oWKYutqjHWhhE0TJbDGpnu9QR8aUZnw6f9VyeYIaw66tbslja+BtcJWWdsWY/1tXmOSdCMn1fPASxEJ96WytXnQkm1gzx15W2Xiz2voz0va+KinX3ExoxhHV/mRaLTM8VJhaag/kNMzbHZyG+VJou/E4wI+ZOtb4fphiAHReIjLfKdpW0mZvbzPKwncNT4/4o3Hxyuw8thVXrakxf51v1yXRT9iQXqelbW30JWy/2MmNFe3NxFSs9/9UcF5MGzNxcaVFfCccU2Ls5/bkPtNs38p2Pm81/MiRVBvIieiIjk5E6wC3egGe9oy1ryqX+EWpf0rhl0l7AZ4N6jkj+8Ep7U5IF/pMJZrI7v+f2faUmeCk2sBsN7YbtnXRU3HKf8Q0TMKjAAvUXQwgO+oe28Ivk2YAXQJgV78gqz7mqO//uXqV0j3D/kad0pUB1nk+HrzvM1pLNVNZTpdo/r4GcsfxW2a5+H3bCsIVRLeLoAK0ifNwLQCNVt+dzX8TaTEVLPqYNWgaA1i5mH8Z1QJAvyawJpkBHvQC5L+UfogyKP9Vfq6ubwa1fBkBgH5MEGcGqNw27pDAx30MYBPl7+KnSmwegC5UCwD9m6DWDFC75wHIOl9lJ5WR+zwHGO0B6ES1ANC/CRJa7QHveU4eblT402lcVJnNZ6q/XmYALEO1ANC/CezinmyeEeFdcupnvXWAbqoM4ROFDzwAN6JaAOjfBJoZoHKX7fTEyfEshT8mvYBcVfzZcQ0ACIABAXiD7fTcLQDZoC+RA/zGA3AZqgWAfk7QStUZtv8TVwOtVcST0+maVSsi2tEEgAAYGIDz9UtJOUD+ALlr7DWLzjTRrWstl+4jAFASQP6oTHH54jn25o4x6MugGwxgFgACoGyAVg6wzABo3WwAXEsHmui+uMZ7MaoFgLL3gALgafZmgdGMnKJ3yuhdAfAUqgWAfgfYclzVHpgB7jcAvkm3y+jsOQAEQNkAFS9A/rT08scBvolqAaBEgFZ+e5YmD8BvjW54Od100o7LAAiA0veA/MRv0/VbOsCrBsDVtNxJKQLgclQLAGUCjOYA1X/oAM/P1wEeoksACIABARjPAf6GAbzI3hwp0AHupFMuShHPcViNagGgTID8xO+ykH/qALPz9QnpD2ixi7YAIADKB5gkzvf20QFmunWAByiDARQPEjmEagGg3wGaTm/UCoBHdIAhLh3g+7SsEgABMBAA7WaAVS59Qvo9aqqkzeJJNjtRLQBsNyaMn9zPR4D8QV0ZSjbRR2zZek0HuIPKKqkBAAGwg3Hlxyd9BlhgAqgYALeQy00N/2t9axgEAD45+vsMMN8MMEsH2ECVAAiAPgJs7/6ADODfTe/cHGBmC0A+Id1M+W5qHs4BHkC1ALBzANu5QyoH+IbpXSXfITKAn5gAfkEF+dR8jF8S/T6qBYBthw6NRY9O7wHNAF0cYIgBcK0O8Et+B9jmC+pEAATAJ0afXkas6PQYcHY7AMP5bwo3v6CeJHoP1QJAvzchZoBODrCKaAB/c04HyFVS5D4O8CyqBYDtxqgRb80cMWKaTwDLBMCJn10wAF40xoIUeVi9BYAA2JEYKcaCP+kwwN+2BnhKqVJVAfC0AZBfDP3FIg4wBdUCQD8nWJlnvolxEweYqKovmAHyG5ePEgC3oFoAKDWBAGh9BCC/DsGxgQPcjGoBoNQEy8Rju1R1n7HnExPS/DSwYxcH2IBqAWBAAB42AxzAAMYqfxzCn16DAECZCTLaAGj9LwPYh18V0+Wf0oDoVgAvGnvARQUCYAprRVAtAJSaYLEBcJEBkJ8Rsf7FRTRHAIxFtQBQNsDljwJUrv6VKEcA7INqAaDUBJcMgBv4m48MgJmfEfUWAHNQLQAMCMBdBsD7/DXxU6JpognJRLUAUDbAm6zrOMaXrZ8YAK2fE60QAKtQLQAMAEAjPACVCUQhivIuUSKqBYBSE9w0AbTeNy5/0b4X+747RFZUCwADBlDxAFS+K6hkADd8ehLFAsAA7gHPEt0RSx9ev84BqiqKBYAB3AMe9wA8pqps9Bfyi1+jWAAoN8FtotveN3c8AA+rKh/9VWEICICBBPgrzwWAr+LgC4BBALiAaIFYyFR/hzIBYCAS3DMD3E+0X1/KzkSZADDgAMuJeqE8ABhggC23YPsWl0ADIAAinieAd4ne8b45T5SM8gBgJyN5bujkGVfCfUpgvWECqGXfOnkE5QHATsaJkb9PHjDppG8JzACVTFUFQAD0KWbN8G0PeMYMMERVz6M8AOhL7B1nLLR7f8DW0QpgoqpmozwA6ENE9ptnLLV7h9THAJpuw7vvAqoDgB2LVndIjZ0xV/FtD/gN7gMNgD6F+Q6psYOWJvqWQANAAHzmcAzanehrgq8AEACfMWJnVDiGDh0KgIjgAOyvjwV9S/CA6G+oCAAGK0EiAAJgUBMAIAACIOL5Bfg1AAIgACKeW4DReBwXAAYxgTUeAAEwmAkAEACDmsAGgAAYzARJAAiAwUzQFw+lBsBgJkgAQAAMZgINAAEwqAmIvkJFADCYAHNREQAEQAQAIgAwGADrUREABEDEcwqwlGyoCAAGL4E9DgUBwB9aAgQAAiACABEACIAIAEQAIAAiuoyPHIujNwLxpHBYcuQCdFgQiKeFQy7AREfOE+Q75H+4HL27QY7unSLHkdhNj/2BGX52j9XoJsUAQKQAQAAEwA5Fz8E9u0GKbrIa3aQYCAQCgUAgEAgEAtF1Y0joz8eNkfGNx2yPsgxgr9bBUZMHFvP+a+ykYdv9eb5nwriZk14ul5piyLaZM8efkJlBXxPLdKk5xEMEo6Svhi/xSsS8XtOHjZLwnU/sHS4Azpo5vHh3VG9FGT31+IKKF/14wuf1/sUj/h06TWaKP58oL98bUSwxA48eodumy1wLZfBrQ4cO7aNIXg2fYvxo9tePJsr55hygNWoW+8D1+6WSE/GKosSG/cu/KfpYxshOofSbJzfDtEHHB06XuhaDXxQvsjeUDxEeNpz9PXagPIDJlgVs6eWlynHLHLaw7Yp/U0RaiiWnSFwY0UtuhqVvKwygzByDh0WF7k6WXQtfItbyEh+CDJIH8CVLLFua+7qyMEIcNuf6NYN1+0C5KfYPC+t3Qu5KLHxtBQcoM8eJ4fuPD4yaI7cWPwyAFaP9mmF0qENuivDIHhMn9ZKZ4aeTRihtAPTzhmIH+qg/yE7x/B2Cx05NVqQf5ZWKuTIzDLCEhYVZLGGRso+PFaO74CE4QE1IuJSBr3VsVLl3bB0ub2xdMVJmht7FLMYtLZa9Fj2nvuWHFP8HTROXoKGAZzMAAAAASUVORK5CYII="> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Optimal regularization parameter : 0.00013141473626117567
</pre>  <pre data-language="python">print(__doc__)

# Author: Alexandre Gramfort &lt;alexandre.gramfort@inria.fr&gt;
# License: BSD 3 clause

import numpy as np
from sklearn import linear_model

# #############################################################################
# Generate sample data
n_samples_train, n_samples_test, n_features = 75, 150, 500
np.random.seed(0)
coef = np.random.randn(n_features)
coef[50:] = 0.0  # only the top 10 features are impacting the model
X = np.random.randn(n_samples_train + n_samples_test, n_features)
y = np.dot(X, coef)

# Split train and test data
X_train, X_test = X[:n_samples_train], X[n_samples_train:]
y_train, y_test = y[:n_samples_train], y[n_samples_train:]

# #############################################################################
# Compute train and test errors
alphas = np.logspace(-5, 1, 60)
enet = linear_model.ElasticNet(l1_ratio=0.7, max_iter=10000)
train_errors = list()
test_errors = list()
for alpha in alphas:
    enet.set_params(alpha=alpha)
    enet.fit(X_train, y_train)
    train_errors.append(enet.score(X_train, y_train))
    test_errors.append(enet.score(X_test, y_test))

i_alpha_optim = np.argmax(test_errors)
alpha_optim = alphas[i_alpha_optim]
print("Optimal regularization parameter : %s" % alpha_optim)

# Estimate the coef_ on full data with optimal regularization parameter
enet.set_params(alpha=alpha_optim)
coef_ = enet.fit(X, y).coef_

# #############################################################################
# Plot results functions

import matplotlib.pyplot as plt
plt.subplot(2, 1, 1)
plt.semilogx(alphas, train_errors, label='Train')
plt.semilogx(alphas, test_errors, label='Test')
plt.vlines(alpha_optim, plt.ylim()[0], np.max(test_errors), color='k',
           linewidth=3, label='Optimum on test')
plt.legend(loc='lower left')
plt.ylim([0, 1.2])
plt.xlabel('Regularization parameter')
plt.ylabel('Performance')

# Show estimated coef_ vs true coef
plt.subplot(2, 1, 2)
plt.plot(coef, label='True coef')
plt.plot(coef_, label='Estimated coef')
plt.legend()
plt.subplots_adjust(0.09, 0.04, 0.94, 0.94, 0.26, 0.26)
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 3.310 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-model-selection-plot-train-error-vs-test-error-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/model_selection/plot_train_error_vs_test_error.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/dcb776e3eb7cce048909ddcd70100917/plot_train_error_vs_test_error.py"><code>Download Python source code: plot_train_error_vs_test_error.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/b49810e68af99a01e25ba2dfc951b687/plot_train_error_vs_test_error.ipynb"><code>Download Jupyter notebook: plot_train_error_vs_test_error.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/model_selection/plot_train_error_vs_test_error.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/model_selection/plot_train_error_vs_test_error.html</a>
  </p>
</div>
