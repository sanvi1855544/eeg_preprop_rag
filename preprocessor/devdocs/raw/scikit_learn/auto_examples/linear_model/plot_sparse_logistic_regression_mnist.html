<h1 id="sphx-glr-auto-examples-linear-model-plot-sparse-logistic-regression-mnist-py">MNIST classification using multinomial logistic + L1</h1> <p>Here we fit a multinomial logistic regression with L1 penalty on a subset of the MNIST digits classification task. We use the SAGA algorithm for this purpose: this a solver that is fast when the number of samples is significantly larger than the number of features and is able to finely optimize non-smooth objective functions which is the case with the l1-penalty. Test accuracy reaches &gt; 0.8, while weight vectors remains <em>sparse</em> and therefore more easily <em>interpretable</em>.</p> <p>Note that this accuracy of this l1-penalized linear model is significantly below what can be reached by an l2-penalized linear model or a non-linear multi-layer perceptron model on this dataset.</p> <img alt="Classification vector for..." class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Sparsity with L1 penalty: 79.95%
Test score with L1 penalty: 0.8322
Example run in 36.916 s
</pre>  <pre data-language="python">import time
import matplotlib.pyplot as plt
import numpy as np

from sklearn.datasets import fetch_openml
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.utils import check_random_state

print(__doc__)

# Author: Arthur Mensch &lt;arthur.mensch@m4x.org&gt;
# License: BSD 3 clause

# Turn down for faster convergence
t0 = time.time()
train_samples = 5000

# Load data from https://www.openml.org/d/554
X, y = fetch_openml('mnist_784', version=1, return_X_y=True, as_frame=False)

random_state = check_random_state(0)
permutation = random_state.permutation(X.shape[0])
X = X[permutation]
y = y[permutation]
X = X.reshape((X.shape[0], -1))

X_train, X_test, y_train, y_test = train_test_split(
    X, y, train_size=train_samples, test_size=10000)

scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# Turn up tolerance for faster convergence
clf = LogisticRegression(
    C=50. / train_samples, penalty='l1', solver='saga', tol=0.1
)
clf.fit(X_train, y_train)
sparsity = np.mean(clf.coef_ == 0) * 100
score = clf.score(X_test, y_test)
# print('Best C % .4f' % clf.C_)
print("Sparsity with L1 penalty: %.2f%%" % sparsity)
print("Test score with L1 penalty: %.4f" % score)

coef = clf.coef_.copy()
plt.figure(figsize=(10, 5))
scale = np.abs(coef).max()
for i in range(10):
    l1_plot = plt.subplot(2, 5, i + 1)
    l1_plot.imshow(coef[i].reshape(28, 28), interpolation='nearest',
                   cmap=plt.cm.RdBu, vmin=-scale, vmax=scale)
    l1_plot.set_xticks(())
    l1_plot.set_yticks(())
    l1_plot.set_xlabel('Class %i' % i)
plt.suptitle('Classification vector for...')

run_time = time.time() - t0
print('Example run in %.3f s' % run_time)
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 37.020 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-linear-model-plot-sparse-logistic-regression-mnist-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/linear_model/plot_sparse_logistic_regression_mnist.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/5a847ed2e1c03e450c5f9dee339423ad/plot_sparse_logistic_regression_mnist.py"><code>Download Python source code: plot_sparse_logistic_regression_mnist.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/2a5eb3b98b9fe593b9bfeb548a54175d/plot_sparse_logistic_regression_mnist.ipynb"><code>Download Jupyter notebook: plot_sparse_logistic_regression_mnist.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/linear_model/plot_sparse_logistic_regression_mnist.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/linear_model/plot_sparse_logistic_regression_mnist.html</a>
  </p>
</div>
