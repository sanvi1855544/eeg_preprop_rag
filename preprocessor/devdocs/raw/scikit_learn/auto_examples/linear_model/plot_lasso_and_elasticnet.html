<h1 id="sphx-glr-auto-examples-linear-model-plot-lasso-and-elasticnet-py">Lasso and Elastic Net for Sparse Signals</h1> <p>Estimates Lasso and Elastic-Net regression models on a manually generated sparse signal corrupted with an additive noise. Estimated coefficients are compared with the ground-truth.</p> <img alt="Lasso $R^2$: 0.658, Elastic Net $R^2$: 0.643" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Lasso(alpha=0.1)
r^2 on test data : 0.658064
ElasticNet(alpha=0.1, l1_ratio=0.7)
r^2 on test data : 0.642515
</pre>  <pre data-language="python">print(__doc__)

import numpy as np
import matplotlib.pyplot as plt

from sklearn.metrics import r2_score

# #############################################################################
# Generate some sparse data to play with
np.random.seed(42)

n_samples, n_features = 50, 100
X = np.random.randn(n_samples, n_features)

# Decreasing coef w. alternated signs for visualization
idx = np.arange(n_features)
coef = (-1) ** idx * np.exp(-idx / 10)
coef[10:] = 0  # sparsify coef
y = np.dot(X, coef)

# Add noise
y += 0.01 * np.random.normal(size=n_samples)

# Split data in train set and test set
n_samples = X.shape[0]
X_train, y_train = X[:n_samples // 2], y[:n_samples // 2]
X_test, y_test = X[n_samples // 2:], y[n_samples // 2:]

# #############################################################################
# Lasso
from sklearn.linear_model import Lasso

alpha = 0.1
lasso = Lasso(alpha=alpha)

y_pred_lasso = lasso.fit(X_train, y_train).predict(X_test)
r2_score_lasso = r2_score(y_test, y_pred_lasso)
print(lasso)
print("r^2 on test data : %f" % r2_score_lasso)

# #############################################################################
# ElasticNet
from sklearn.linear_model import ElasticNet

enet = ElasticNet(alpha=alpha, l1_ratio=0.7)

y_pred_enet = enet.fit(X_train, y_train).predict(X_test)
r2_score_enet = r2_score(y_test, y_pred_enet)
print(enet)
print("r^2 on test data : %f" % r2_score_enet)

m, s, _ = plt.stem(np.where(enet.coef_)[0], enet.coef_[enet.coef_ != 0],
                   markerfmt='x', label='Elastic net coefficients',
                   use_line_collection=True)
plt.setp([m, s], color="#2ca02c")
m, s, _ = plt.stem(np.where(lasso.coef_)[0], lasso.coef_[lasso.coef_ != 0],
                   markerfmt='x', label='Lasso coefficients',
                   use_line_collection=True)
plt.setp([m, s], color='#ff7f0e')
plt.stem(np.where(coef)[0], coef[coef != 0], label='true coefficients',
         markerfmt='bx', use_line_collection=True)

plt.legend(loc='best')
plt.title("Lasso $R^2$: %.3f, Elastic Net $R^2$: %.3f"
          % (r2_score_lasso, r2_score_enet))
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.147 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-linear-model-plot-lasso-and-elasticnet-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/0.24.X?urlpath=lab/tree/notebooks/auto_examples/linear_model/plot_lasso_and_elasticnet.ipynb"><img alt="Launch binder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAAAUCAMAAACwC0NtAAABWVBMVEW7u7vo6OjCwsLMzMzz8/P4+Pju7u68vLzd3d24uLjx8fHm5ubT09PAwMDJycnPz8+urq7Ly8va2tq5ubnq6uqSkpLBwcH09PS6urrypVmvr6/i4uLDw8O0tLSjo6PX19e9u7pYm8qxsbGrq6u+vr7s7OzZ2dng4OCVlZXk5OTIyMiWlpampqaoqKj6+vrGxsagoKC9vb2ZmZn29vb///+Nq8Kzs7PSspNlnshfnsr2o1HnZYHXc46dnZ2Li4vS0tKPj4+3t7fOtJm2urztpmKGqsTarYFcmsnTjZzkaYXOl6Kqtr7lqnHEqrD1olLMmqW+t7jWsIzGt6hrnsbQk6Gis7/IoavgbIfhcoprlcHYaom+oH2Elq50kLzV1dWHh4fDuK2Xr8GZsMDHtqatsLrglH/sfm60pLHKqqDWnJHJcJDtgWzoknG8dJaLqr/0lVqeo7jlbX7owswW4TTQAAACXklEQVRIx+3V52/iMBgH4DcsBwfCCCkhQICMS4G0AQKUXqFpumh7Pa57l9t7//9fzlRHWeXbCemkvpEs+ZWtR/rZVqAKj/WvK7u+v7m/np2RdpjokG9pNthRIrF0dJjYfDWLGM/ed76dAWx31v923NS0tWXvRCtD90bTN9Sy1Ona3u6Hp1939+Cw04/SRU9bizwTLTbUG9OtoRZGU7Hn5xefEz9/Nz9tJt4ONDOGky7Q52AuCbStYRvKOmZcyENjKjWqPYnFdZSiQbd9vhCkyMyDUBQzBbC7WmhMe7Gyk92+vrm9ud7ODjRKLQZoiKmgakBTRcULdKboZlDVXMtERzWvMU915xhgknwag2auRaook2/JlhqKi+EJ7QR+5NqX7XYNBtq8wtIZYFQoUxAtc2ELsORIYbS4AGpgLEnZqetqHpKOIGLVKwnSIqIKrKkVIm6FG09y9+Jj4/Z789fy8rOBlsddd7enBYlGDt0Cyw+CiDwcmGOaDRC808ix+lRysIKFtG4g4IKIe/JK7qycf7kicW7l3txrQS9fYomWAptoqZ6mu8HEvVsyrmkIomxPCxLNwQVgSZKpkkT7I6HJa3Jw0rxq7h3AVu71veaPMfkkNlmc1PuaEs/HOYSJZo9qOo5pRl8D0aI0DRkeBnedhzSAd5fHpxunjfskw0Xg5YV5w9+qiBUeigrASxD5esXgVgGM1shmg68srDkyT7aAfxUUXuFXuTovSxWQSg++gq3c8nE7VxvqcOE6iA6kRRD6LSecfvgNObIwPBOFu/3y1De3UWvkGrWNx9/T/1B/AFudUABdgF9sAAAAAElFTkSuQmCC" style="width: 150px;"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/3d58721191491072eecc520f0a45cdb3/plot_lasso_and_elasticnet.py"><code>Download Python source code: plot_lasso_and_elasticnet.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/0.24/_downloads/6cd2f23417e24a8a2a445c34f1b57930/plot_lasso_and_elasticnet.ipynb"><code>Download Jupyter notebook: plot_lasso_and_elasticnet.ipynb</code></a></p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2020 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/0.24/auto_examples/linear_model/plot_lasso_and_elasticnet.html" class="_attribution-link">https://scikit-learn.org/0.24/auto_examples/linear_model/plot_lasso_and_elasticnet.html</a>
  </p>
</div>
